<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>
		无常是常
	</title>
	<meta name="description" content="">
	<link rel="shortcut icon" href="/img/favicon.ico">

	<!-- Tailwind CSS -->
	
<link rel="stylesheet" href="/css/main.css">


		<!-- Dark Mode Script -->
		<script>
			// 深色模式初始化
			if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
				document.documentElement.classList.add('dark')
			} else {
				document.documentElement.classList.remove('dark')
			}

			// 深色模式切换函数
			function toggleDarkMode() {
				if (document.documentElement.classList.contains('dark')) {
					document.documentElement.classList.remove('dark')
					localStorage.theme = 'light'
				} else {
					document.documentElement.classList.add('dark')
					localStorage.theme = 'dark'
				}
			}

			// 搜索功能
			function performSearch() {
				const query = document.getElementById('search-input').value.toLowerCase();
				const resultsContainer = document.getElementById('search-results');
				const loadingElement = document.getElementById('search-loading');
				const emptyElement = document.getElementById('search-empty');

				if (!query.trim()) {
					resultsContainer.innerHTML = '';
					emptyElement.classList.add('hidden');
					return;
				}

				loadingElement.classList.remove('hidden');
				emptyElement.classList.add('hidden');

				// 模拟搜索延迟
				setTimeout(() => {
					fetch('/search.json')
						.then(response => response.json())
						.then(data => {
							const results = data.filter(post =>
								post.title.toLowerCase().includes(query) ||
								post.content.toLowerCase().includes(query) ||
								(post.tags && post.tags.some(tag => tag.toLowerCase().includes(query)))
							);

							loadingElement.classList.add('hidden');

							if (results.length === 0) {
								emptyElement.classList.remove('hidden');
								resultsContainer.innerHTML = '';
							} else {
								emptyElement.classList.add('hidden');
								displaySearchResults(results, query);
							}
						})
						.catch(error => {
							console.error('搜索出错:', error);
							loadingElement.classList.add('hidden');
							emptyElement.classList.remove('hidden');
						});
				}, 300);
			}

			function displaySearchResults(results, query) {
				const resultsContainer = document.getElementById('search-results');
				resultsContainer.innerHTML = results.map(post => {
					const highlightedTitle = highlightText(post.title, query);
					const excerpt = getExcerpt(post.content, query);
					const highlightedExcerpt = highlightText(excerpt, query);

					return `
					<article class="bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 p-6 border border-gray-200 dark:border-gray-700">
						<h3 class="text-xl font-semibold mb-2">
							<a href="${post.url}" class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
								${highlightedTitle}
							</a>
						</h3>
						<p class="text-gray-600 dark:text-gray-300 mb-3 leading-relaxed">
							${highlightedExcerpt}
						</p>
						<div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
							<time datetime="${post.date}">${new Date(post.date).toLocaleDateString('zh-CN')}</time>
							${post.tags ? `<div class="flex gap-2">${post.tags.map(tag => `<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full text-xs">${tag}</span>`).join('')}</div>` : ''}
						</div>
					</article>
				`;
				}).join('');
			}

			function highlightText(text, query) {
				if (!query) return text;
				const regex = new RegExp(`(${query})`, 'gi');
				return text.replace(regex, '<mark class="bg-yellow-200 dark:bg-yellow-800 px-1 rounded">$1</mark>');
			}

			function getExcerpt(content, query, maxLength = 200) {
				const queryIndex = content.toLowerCase().indexOf(query.toLowerCase());
				if (queryIndex === -1) {
					return content.substring(0, maxLength) + (content.length > maxLength ? '...' : '');
				}

				const start = Math.max(0, queryIndex - 50);
				const end = Math.min(content.length, queryIndex + query.length + 150);
				let excerpt = content.substring(start, end);

				if (start > 0) excerpt = '...' + excerpt;
				if (end < content.length) excerpt = excerpt + '...';

				return excerpt;
			}
		</script>
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="无常是常" type="application/atom+xml">
</head>
    

        <body
            class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300 category">
            <div class="flex flex-col">
                <!-- 头部导航 -->
                <header class="bg-white dark:bg-gray-800 shadow-md">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="flex justify-between items-center h-16">
				<div class="flex-shrink-0">
					<a href="/" class="flex items-center">						
						
						<span class="ml-2 text-xl font-bold text-gray-900 dark:text-white">无常是常</span>
					</a>
				</div>
				<div class="hidden md:block">
					<nav class="ml-10 flex items-baseline space-x-4">
						
						<a href="/" 
							class="text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white px-3 py-2 rounded-md text-md font-medium">
							文章
						</a>
						
						<a href="/about" 
							class="text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white px-3 py-2 rounded-md text-md font-medium">
							关于
						</a>
						
					</nav>
				</div>

				<div class="flex items-center space-x-4">
					<!-- 搜索按钮 -->
					<a href="/search/" class="p-2 rounded-md text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white focus:outline-none transition-colors" title="搜索">
						<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg>
					</a>
					
					<!-- 深色模式切换 -->
					<button id="theme-toggle" class="p-2 rounded-md text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white focus:outline-none transition-colors" title="切换主题">
						<span id="theme-toggle-dark-icon" class="hidden"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"></path></svg></span>
						<span id="theme-toggle-light-icon" class="hidden"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></span>
					</button>
					
					<!-- 移动端菜单按钮 -->
					<button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white focus:outline-none transition-colors">
						<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg>
					</button>
				</div>
			</div>
			
			<!-- 移动端菜单 -->
			<div id="mobile-menu" class="hidden md:hidden">
				<div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 border-t border-gray-200 dark:border-gray-700">
					
					<a href="/" 
						class="text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">
						文章
					</a>
					
					<a href="/about" 
						class="text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">
						关于
					</a>
					
				</div>
			</div>
		</div>
	</div>
</header>

                    <!-- 主要内容区域 -->
                    <main class="flex-1">
                        <div class="mx-auto px-2 sm:px-6 lg:px-8 py-8 max-w-7xl">
                            <div class="main-layout flex flex-col lg:flex-row gap-8">
                                <!-- 主内容区 -->
                                <div class="main-content flex-1">
                                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 md:p-12 lg:p-16">
                                        <!-- Hero Section -->
<div class="bg-gradient-to-br from-primary-50 to-blue-50 dark:from-gray-800 dark:to-gray-900 -mx-4 -mt-4 mb-8 px-6 py-8 rounded-t-lg">
    <div class="text-center">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">
            无常是常
        </h1>
        <p class="text-lg text-gray-600 dark:text-gray-300 mb-6 max-w-2xl mx-auto">
            分享技术见解、学习心得和生活感悟
        </p>
        <div class="flex justify-center space-x-4">
            <a href="/archives" class="btn btn-primary">
                浏览文章
            </a>
            <a href="/about" class="btn btn-secondary">
                了解更多
            </a>
        </div>
    </div>
</div>

<!-- 最新文章列表 -->
<div class="space-y-6">
    <div class="mb-6 flex items-center">
        <div class="w-1 h-8 bg-primary-600 mr-3"></div>
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white flex items-center">
            最新文章
        </h2>
    </div>
    
    <div class="space-y-6">
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2025/06/15/%E5%B8%B8%E7%94%A8%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                常用构建脚本
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-0">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <h2 id="镜像构建脚本">镜像构建脚本</h2>
<p>build-image-web.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">if [ &quot;$&#123;BUILD_DIR&#125;&quot; == &quot;&quot; ];then</span><br><span class="line">    echo &quot;env &#x27;BUILD_DIR&#x27; is not set&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">DOCKER_DIR=$&#123;BUILD_DIR&#125;/$&#123;JOB_NAME&#125;</span><br><span class="line"></span><br><span class="line">if [ ! -d $&#123;DOCKER_DIR&#125; ];then</span><br><span class="line">    mkdir -p $&#123;DOCKER_DIR&#125;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;docker workspace: $&#123;DOCKER_DIR&#125;&quot;</span><br><span class="line"></span><br><span class="line">JENKINS_DIR=$&#123;WORKSPACE&#125;/$&#123;MODULE&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;jenkins workspace: $&#123;JENKINS_DIR&#125;&quot;</span><br><span class="line"></span><br><span class="line">PROJECT_DIR=$&#123;JENKINS_DIR&#125;$&#123;JOB_NAME&#125;-web</span><br><span class="line"></span><br><span class="line">echo &quot;project workspace: $&#123;PROJECT_DIR&#125;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if [ ! -f $&#123;PROJECT_DIR&#125;/target/*.jar ];then</span><br><span class="line">    echo &quot;target jar file not found $&#123;PROJECT_DIR&#125;/target/*.jar&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">cd $&#123;DOCKER_DIR&#125;</span><br><span class="line">rm -fr *.jar Dockerfile</span><br><span class="line"></span><br><span class="line">DOCKER_FILE=/opt/script/Dockerfile</span><br><span class="line"></span><br><span class="line">cp $&#123;PROJECT_DIR&#125;/target/*.jar .</span><br><span class="line">cp $&#123;DOCKER_FILE&#125; .</span><br><span class="line"></span><br><span class="line">sed -i &quot;s,&#123;&#123;JOB_NAME&#125;&#125;,$&#123;JOB_NAME&#125;,g&quot; Dockerfile</span><br><span class="line"></span><br><span class="line">VERSION=$(date +%Y%m%d%H%M%S)</span><br><span class="line"></span><br><span class="line">IMAGE_NAME=harbor.merchant.com/kubernetes/$&#123;JOB_NAME&#125;:$&#123;VERSION&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;$&#123;IMAGE_NAME&#125;&quot; &gt; $&#123;WORKSPACE&#125;/IMAGE</span><br><span class="line"></span><br><span class="line">echo &quot;building image: $&#123;IMAGE_NAME&#125;&quot;</span><br><span class="line">docker build -t $&#123;IMAGE_NAME&#125; .</span><br><span class="line"></span><br><span class="line">docker push $&#123;IMAGE_NAME&#125;</span><br><span class="line"></span><br><span class="line">helm list -n default</span><br><span class="line">helm upgrade $&#123;JOB_NAME&#125; --set name=$&#123;JOB_NAME&#125; --set version=$VERSION --set httpPorts=8080  -n default  /opt/charts/</span><br></pre></td></tr></table></figure>
<h2 id="Dockerfile">Dockerfile</h2>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> LANG en_US.UTF-<span class="number">8</span></span><br><span class="line"><span class="keyword">ENV</span> LANGUAGE en_US:en</span><br><span class="line"><span class="keyword">ENV</span> LC_ALL en_US.UTF-<span class="number">8</span></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">ENV</span> apollo.meta http://<span class="number">192.168</span>.<span class="number">3.183</span>:<span class="number">8080</span></span><br><span class="line"><span class="keyword">ENV</span> APOLLO_LABEL XianDevLabel</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> &#123;&#123;JOB_NAME&#125;&#125;.jar /&#123;&#123;JOB_NAME&#125;&#125;.jar</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-Dapollo.label=XianDevLabel&quot;</span>,<span class="string">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class="string">&quot;-jar&quot;</span>,<span class="string">&quot;&#123;&#123;JOB_NAME&#125;&#125;.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>
                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-0">
                                        <div class="post-content" data-content-type="full">
                                            <h2 id="镜像构建脚本">镜像构建脚本</h2>
<p>build-image-web.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">if [ &quot;$&#123;BUILD_DIR&#125;&quot; == &quot;&quot; ];then</span><br><span class="line">    echo &quot;env &#x27;BUILD_DIR&#x27; is not set&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">DOCKER_DIR=$&#123;BUILD_DIR&#125;/$&#123;JOB_NAME&#125;</span><br><span class="line"></span><br><span class="line">if [ ! -d $&#123;DOCKER_DIR&#125; ];then</span><br><span class="line">    mkdir -p $&#123;DOCKER_DIR&#125;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;docker workspace: $&#123;DOCKER_DIR&#125;&quot;</span><br><span class="line"></span><br><span class="line">JENKINS_DIR=$&#123;WORKSPACE&#125;/$&#123;MODULE&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;jenkins workspace: $&#123;JENKINS_DIR&#125;&quot;</span><br><span class="line"></span><br><span class="line">PROJECT_DIR=$&#123;JENKINS_DIR&#125;$&#123;JOB_NAME&#125;-web</span><br><span class="line"></span><br><span class="line">echo &quot;project workspace: $&#123;PROJECT_DIR&#125;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if [ ! -f $&#123;PROJECT_DIR&#125;/target/*.jar ];then</span><br><span class="line">    echo &quot;target jar file not found $&#123;PROJECT_DIR&#125;/target/*.jar&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">cd $&#123;DOCKER_DIR&#125;</span><br><span class="line">rm -fr *.jar Dockerfile</span><br><span class="line"></span><br><span class="line">DOCKER_FILE=/opt/script/Dockerfile</span><br><span class="line"></span><br><span class="line">cp $&#123;PROJECT_DIR&#125;/target/*.jar .</span><br><span class="line">cp $&#123;DOCKER_FILE&#125; .</span><br><span class="line"></span><br><span class="line">sed -i &quot;s,&#123;&#123;JOB_NAME&#125;&#125;,$&#123;JOB_NAME&#125;,g&quot; Dockerfile</span><br><span class="line"></span><br><span class="line">VERSION=$(date +%Y%m%d%H%M%S)</span><br><span class="line"></span><br><span class="line">IMAGE_NAME=harbor.merchant.com/kubernetes/$&#123;JOB_NAME&#125;:$&#123;VERSION&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;$&#123;IMAGE_NAME&#125;&quot; &gt; $&#123;WORKSPACE&#125;/IMAGE</span><br><span class="line"></span><br><span class="line">echo &quot;building image: $&#123;IMAGE_NAME&#125;&quot;</span><br><span class="line">docker build -t $&#123;IMAGE_NAME&#125; .</span><br><span class="line"></span><br><span class="line">docker push $&#123;IMAGE_NAME&#125;</span><br><span class="line"></span><br><span class="line">helm list -n default</span><br><span class="line">helm upgrade $&#123;JOB_NAME&#125; --set name=$&#123;JOB_NAME&#125; --set version=$VERSION --set httpPorts=8080  -n default  /opt/charts/</span><br></pre></td></tr></table></figure>
<h2 id="Dockerfile">Dockerfile</h2>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> LANG en_US.UTF-<span class="number">8</span></span><br><span class="line"><span class="keyword">ENV</span> LANGUAGE en_US:en</span><br><span class="line"><span class="keyword">ENV</span> LC_ALL en_US.UTF-<span class="number">8</span></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">ENV</span> apollo.meta http://<span class="number">192.168</span>.<span class="number">3.183</span>:<span class="number">8080</span></span><br><span class="line"><span class="keyword">ENV</span> APOLLO_LABEL XianDevLabel</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> &#123;&#123;JOB_NAME&#125;&#125;.jar /&#123;&#123;JOB_NAME&#125;&#125;.jar</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-Dapollo.label=XianDevLabel&quot;</span>,<span class="string">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class="string">&quot;-jar&quot;</span>,<span class="string">&quot;&#123;&#123;JOB_NAME&#125;&#125;.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>
                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2025-06-15T04:02:33.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2025-06-15
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/%E8%84%9A%E6%9C%AC/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                脚本
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="0" id="btn-0">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2025/06/11/mermaid/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                mermaid
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-1">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <p>Mermaid 图表展示</p>
<p>这是一个展示Mermaid图表功能的文章，同时也演示了目录功能。</p>
<h2 id="思维导图-mindmap">思维导图 (mindmap)</h2>
<pre class="mermaid">mindmap
  root((mindmap))
    Origins
      Long history
      ::icon(fa fa-book)
      Popularisation
        British popular psychology author Tony Buzan
    Research
      On effectiveness<br/>and features
      On Automatic creation
        Uses
            Creative techniques
            Strategic planning
            Argument mapping
    Tools
      Pen and paper
      Mermaid</pre>
<h2 id="状态图-stateDiagram">状态图 (stateDiagram)</h2>
<pre class="mermaid">stateDiagram-v2
    [*] --> Still
    Still --> [*]
    Still --> Moving
    Moving --> Still
    Moving --> Crash
    Crash --> [*]</pre>
<h2 id="类图-classDiagram">类图 (classDiagram)</h2>
<pre class="mermaid">classDiagram
    Animal <|-- Duck
    Animal <|-- Fish
    Animal <|-- Zebra
    Animal : +int age
    Animal : +String gender
    Animal: +isMammal()
    Animal: +mate()
    class Duck{
      +String beakColor
      +swim()
      +quack()
    }
    class Fish{
      -int sizeInFeet
      -canEat()
    }
    class Zebra{
      +bool is_wild
      +run()
    }</pre>
<h2 id="象限图-quadrantChart">象限图 (quadrantChart)</h2>
<pre class="mermaid">quadrantChart
    title Reach and engagement of campaigns
    x-axis Low Reach --> High Reach
    y-axis Low Engagement --> High Engagement
    quadrant-1 We should expand
    quadrant-2 Need to promote
    quadrant-3 Re-evaluate
    quadrant-4 May be improved
    Campaign A: [0.3, 0.6]
    Campaign B: [0.45, 0.23]
    Campaign C: [0.57, 0.69]
    Campaign D: [0.78, 0.34]
    Campaign E: [0.40, 0.34]
    Campaign F: [0.35, 0.78]</pre>
<h2 id="流程图示例">流程图示例</h2>
<h2 id="简单流程图">简单流程图</h2>
<pre class="mermaid">flowchart TD
    A[开始] --> B{是否有条件}
    B -->|是| C[执行操作A]
    B -->|否| D[执行操作B]
    C --> E[结束]
    D --> E</pre>
<h2 id="复杂流程图">复杂流程图</h2>
<pre class="mermaid">flowchart LR
    A[用户请求] --> B[身份验证]
    B -->|成功| C[处理请求]
    B -->|失败| D[返回错误]
    C --> E[数据库查询]
    E --> F[数据处理]
    F --> G[返回结果]</pre>
<h2 id="甘特图示例">甘特图示例</h2>
<pre class="mermaid">gantt
    section Section
    Completed :done,    des1, 2014-01-06,2014-01-08
    Active        :active,  des2, 2014-01-07, 3d
    Parallel 1   :         des3, after des1, 1d
    Parallel 2   :         des4, after des1, 1d
    Parallel 3   :         des5, after des3, 1d
    Parallel 4   :         des6, after des4, 1d</pre>
<h2 id="时序图示例">时序图示例</h2>
<pre class="mermaid">sequenceDiagram
Alice->>John: Hello John, how are you?
loop HealthCheck
    John->>John: Fight against hypochondria
end
Note right of John: Rational thoughts!
John-->>Alice: Great!
John->>Bob: How about you?
Bob-->>John: Jolly good!</pre>
<h2 id="C4">C4</h2>
<pre class="mermaid">C4Context
title System Context diagram for Internet Banking System

Person(customerA, "Banking Customer A", "A customer of the bank, with personal bank accounts.")
Person(customerB, "Banking Customer B")
Person_Ext(customerC, "Banking Customer C")
System(SystemAA, "Internet Banking System", "Allows customers to view information about their bank accounts, and make payments.")

Person(customerD, "Banking Customer D", "A customer of the bank, <br/> with personal bank accounts.")

Enterprise_Boundary(b1, "BankBoundary") {

  SystemDb_Ext(SystemE, "Mainframe Banking System", "Stores all of the core banking information about customers, accounts, transactions, etc.")

  System_Boundary(b2, "BankBoundary2") {
    System(SystemA, "Banking System A")
    System(SystemB, "Banking System B", "A system of the bank, with personal bank accounts.")
  }

  System_Ext(SystemC, "E-mail system", "The internal Microsoft Exchange e-mail system.")
  SystemDb(SystemD, "Banking System D Database", "A system of the bank, with personal bank accounts.")

  Boundary(b3, "BankBoundary3", "boundary") {
    SystemQueue(SystemF, "Banking System F Queue", "A system of the bank, with personal bank accounts.")
    SystemQueue_Ext(SystemG, "Banking System G Queue", "A system of the bank, with personal bank accounts.")
  }
}

BiRel(customerA, SystemAA, "Uses")
BiRel(SystemAA, SystemE, "Uses")
Rel(SystemAA, SystemC, "Sends e-mails", "SMTP")
Rel(SystemC, customerA, "Sends e-mails to")</pre>
<h2 id="Journey">Journey</h2>
<pre class="mermaid">  journey
    title My working day
    section Go to work
      Make tea: 5: Me
      Go upstairs: 3: Me
      Do work: 1: Me, Cat
    section Go home
      Go downstairs: 5: Me
      Sit down: 3: Me</pre>
<h2 id="Bar-Chart">Bar Chart</h2>
<pre class="mermaid">gantt
    title Git Issues - days since last update
    dateFormat  X
    axisFormat %s

    section Issue19062
    71   : 0, 71
    section Issue19401
    36   : 0, 36
    section Issue193
    34   : 0, 34
    section Issue7441
    9    : 0, 9
    section Issue1300
    5    : 0, 5</pre>
<h2 id="Git-Graph">Git Graph</h2>
<pre class="mermaid">gitGraph
  commit
  commit
  branch develop
  checkout develop
  commit
  commit
  checkout main
  merge develop
  commit
  commit</pre>
<h2 id="Pie">Pie</h2>
<pre class="mermaid">pie
"Dogs" : 386
"Cats" : 85.9
"Rats" : 15</pre>
<h2 id="总结">总结</h2>
<p>通过以上示例，我们可以看到Mermaid支持多种类型的图表：</p>
<ul>
<li>思维导图：用于整理思路和概念</li>
<li>状态图：用于描述系统状态变化</li>
<li>类图：用于展示类之间的关系</li>
<li>象限图：用于分析和分类</li>
<li>流程图：用于描述业务流程</li>
<li>时序图：用于展示交互过程</li>
</ul>
<p>这些图表都可以通过简单的文本语法来创建，非常适合技术文档和博客文章。</p>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-1">
                                        <div class="post-content" data-content-type="full">
                                            <p>Mermaid 图表展示</p>
<p>这是一个展示Mermaid图表功能的文章，同时也演示了目录功能。</p>
<h2 id="思维导图-mindmap">思维导图 (mindmap)</h2>
<pre class="mermaid">mindmap
  root((mindmap))
    Origins
      Long history
      ::icon(fa fa-book)
      Popularisation
        British popular psychology author Tony Buzan
    Research
      On effectiveness<br/>and features
      On Automatic creation
        Uses
            Creative techniques
            Strategic planning
            Argument mapping
    Tools
      Pen and paper
      Mermaid</pre>
<h2 id="状态图-stateDiagram">状态图 (stateDiagram)</h2>
<pre class="mermaid">stateDiagram-v2
    [*] --> Still
    Still --> [*]
    Still --> Moving
    Moving --> Still
    Moving --> Crash
    Crash --> [*]</pre>
<h2 id="类图-classDiagram">类图 (classDiagram)</h2>
<pre class="mermaid">classDiagram
    Animal <|-- Duck
    Animal <|-- Fish
    Animal <|-- Zebra
    Animal : +int age
    Animal : +String gender
    Animal: +isMammal()
    Animal: +mate()
    class Duck{
      +String beakColor
      +swim()
      +quack()
    }
    class Fish{
      -int sizeInFeet
      -canEat()
    }
    class Zebra{
      +bool is_wild
      +run()
    }</pre>
<h2 id="象限图-quadrantChart">象限图 (quadrantChart)</h2>
<pre class="mermaid">quadrantChart
    title Reach and engagement of campaigns
    x-axis Low Reach --> High Reach
    y-axis Low Engagement --> High Engagement
    quadrant-1 We should expand
    quadrant-2 Need to promote
    quadrant-3 Re-evaluate
    quadrant-4 May be improved
    Campaign A: [0.3, 0.6]
    Campaign B: [0.45, 0.23]
    Campaign C: [0.57, 0.69]
    Campaign D: [0.78, 0.34]
    Campaign E: [0.40, 0.34]
    Campaign F: [0.35, 0.78]</pre>
<h2 id="流程图示例">流程图示例</h2>
<h2 id="简单流程图">简单流程图</h2>
<pre class="mermaid">flowchart TD
    A[开始] --> B{是否有条件}
    B -->|是| C[执行操作A]
    B -->|否| D[执行操作B]
    C --> E[结束]
    D --> E</pre>
<h2 id="复杂流程图">复杂流程图</h2>
<pre class="mermaid">flowchart LR
    A[用户请求] --> B[身份验证]
    B -->|成功| C[处理请求]
    B -->|失败| D[返回错误]
    C --> E[数据库查询]
    E --> F[数据处理]
    F --> G[返回结果]</pre>
<h2 id="甘特图示例">甘特图示例</h2>
<pre class="mermaid">gantt
    section Section
    Completed :done,    des1, 2014-01-06,2014-01-08
    Active        :active,  des2, 2014-01-07, 3d
    Parallel 1   :         des3, after des1, 1d
    Parallel 2   :         des4, after des1, 1d
    Parallel 3   :         des5, after des3, 1d
    Parallel 4   :         des6, after des4, 1d</pre>
<h2 id="时序图示例">时序图示例</h2>
<pre class="mermaid">sequenceDiagram
Alice->>John: Hello John, how are you?
loop HealthCheck
    John->>John: Fight against hypochondria
end
Note right of John: Rational thoughts!
John-->>Alice: Great!
John->>Bob: How about you?
Bob-->>John: Jolly good!</pre>
<h2 id="C4">C4</h2>
<pre class="mermaid">C4Context
title System Context diagram for Internet Banking System

Person(customerA, "Banking Customer A", "A customer of the bank, with personal bank accounts.")
Person(customerB, "Banking Customer B")
Person_Ext(customerC, "Banking Customer C")
System(SystemAA, "Internet Banking System", "Allows customers to view information about their bank accounts, and make payments.")

Person(customerD, "Banking Customer D", "A customer of the bank, <br/> with personal bank accounts.")

Enterprise_Boundary(b1, "BankBoundary") {

  SystemDb_Ext(SystemE, "Mainframe Banking System", "Stores all of the core banking information about customers, accounts, transactions, etc.")

  System_Boundary(b2, "BankBoundary2") {
    System(SystemA, "Banking System A")
    System(SystemB, "Banking System B", "A system of the bank, with personal bank accounts.")
  }

  System_Ext(SystemC, "E-mail system", "The internal Microsoft Exchange e-mail system.")
  SystemDb(SystemD, "Banking System D Database", "A system of the bank, with personal bank accounts.")

  Boundary(b3, "BankBoundary3", "boundary") {
    SystemQueue(SystemF, "Banking System F Queue", "A system of the bank, with personal bank accounts.")
    SystemQueue_Ext(SystemG, "Banking System G Queue", "A system of the bank, with personal bank accounts.")
  }
}

BiRel(customerA, SystemAA, "Uses")
BiRel(SystemAA, SystemE, "Uses")
Rel(SystemAA, SystemC, "Sends e-mails", "SMTP")
Rel(SystemC, customerA, "Sends e-mails to")</pre>
<h2 id="Journey">Journey</h2>
<pre class="mermaid">  journey
    title My working day
    section Go to work
      Make tea: 5: Me
      Go upstairs: 3: Me
      Do work: 1: Me, Cat
    section Go home
      Go downstairs: 5: Me
      Sit down: 3: Me</pre>
<h2 id="Bar-Chart">Bar Chart</h2>
<pre class="mermaid">gantt
    title Git Issues - days since last update
    dateFormat  X
    axisFormat %s

    section Issue19062
    71   : 0, 71
    section Issue19401
    36   : 0, 36
    section Issue193
    34   : 0, 34
    section Issue7441
    9    : 0, 9
    section Issue1300
    5    : 0, 5</pre>
<h2 id="Git-Graph">Git Graph</h2>
<pre class="mermaid">gitGraph
  commit
  commit
  branch develop
  checkout develop
  commit
  commit
  checkout main
  merge develop
  commit
  commit</pre>
<h2 id="Pie">Pie</h2>
<pre class="mermaid">pie
"Dogs" : 386
"Cats" : 85.9
"Rats" : 15</pre>
<h2 id="总结">总结</h2>
<p>通过以上示例，我们可以看到Mermaid支持多种类型的图表：</p>
<ul>
<li>思维导图：用于整理思路和概念</li>
<li>状态图：用于描述系统状态变化</li>
<li>类图：用于展示类之间的关系</li>
<li>象限图：用于分析和分类</li>
<li>流程图：用于描述业务流程</li>
<li>时序图：用于展示交互过程</li>
</ul>
<p>这些图表都可以通过简单的文本语法来创建，非常适合技术文档和博客文章。</p>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2025-06-11T14:11:19.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2025-06-11
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/mermiad/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                mermiad
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="1" id="btn-1">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2025/01/01/2025%E6%91%98%E6%8A%84/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                2025摘抄
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-2">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <p>2025/02/08</p>
<p>一念放下，天地皆宽。那些强求不放的事，都会成为自己的深渊</p>
<blockquote>
<p>蒲松龄写过一个执迷象棋的书生。书生途经扬州时，见一位梁将军在林子里喝酒下棋，便徘徊棋桌旁，不愿离去。<br>
梁将军邀请他下一盘，一连三局，书生都败下阵来。书生不服气，一直下到夜幕降临。<br>
就在这时，忽然一阵阴风扫过，书生竟跪地痛哭，拉着梁将军的衣角，求他救救自己。<br>
原来，书生早已做鬼。他生前执迷于下棋，荒废了学业。家里打也打了，骂也骂了，可书生就是割舍不下。<br>
他把父亲活活气死，因“大不孝”的罪名被阎王索了性命，打入饿鬼狱。<br>
因他颇有才华，阎王又派他给东岳大帝的凤楼写碑文，如果写好了，可放他还阳。<br>
结果在前往凤楼的路上，书生巧遇梁将军的棋局，执念再起，耽误了行程。阎王知道后，任是谁来求情，都不再宽恕他。<br>
这两个故事告诉我们，<strong>无论是对物质的贪恋，还是对成就的追求，一旦成为执念，就会变成心灵的枷锁。</strong></p>
</blockquote>
<p>2025/02/21</p>
<p>不纠结过河的筏子</p>
<p>不迷恋肉身。既不迷恋自己的肉身，也不迷恋身边人的肉<br>
身。无论如何青春的肉体终会消逝，可以珍惜的时候就要好好珍惜，<br>
能够展现的时候就要尽情展现，不要等到肉身衰老，禽兽无能，眼前<br>
花盛开，鸟却飞不起来，才后悔莫及。  — 冯唐</p>
<p>2025/04/25</p>
<p>人生没有意义，它才自由，没意义不等于摆烂，什么都不做。</p>
<p>一朵花开在山里无人问津，另外一朵花被搬进奢华的房间，他们都还是花，一个活成了别人想要的样子，另一个无拘无束，活成了自己想要的样子 ——— 致人生的意义</p>
<p>空白才有无限可能！回归内心的空白，结果不是自我价值的终身判决。当你不需要意义证明自己时，反而变得更有力量，激发出更纯粹的创造力，不要沉迷于别人定义好的路，<br>
每个人有自己的路，不需要你去拯救或者批判，做好自己就好</p>
<p>2025/07/02</p>
<blockquote>
<p>“唐肃宗乾元年间，录事薛某高烧中梦见自己变成一条金色鲤鱼，几日不曾觅食，肚中甚是饥饿。此时，正遇一渔夫垂钓，他明知饵里有钩，却耐不住饵香扑鼻，张口吞饵，结果被渔翁钓了上来。” ————《醒世恒言》第26卷《薛录事鱼服证仙》</p>
</blockquote>
<p>欲望是处处都是陷阱。</p>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-2">
                                        <div class="post-content" data-content-type="full">
                                            <p>2025/02/08</p>
<p>一念放下，天地皆宽。那些强求不放的事，都会成为自己的深渊</p>
<blockquote>
<p>蒲松龄写过一个执迷象棋的书生。书生途经扬州时，见一位梁将军在林子里喝酒下棋，便徘徊棋桌旁，不愿离去。<br>
梁将军邀请他下一盘，一连三局，书生都败下阵来。书生不服气，一直下到夜幕降临。<br>
就在这时，忽然一阵阴风扫过，书生竟跪地痛哭，拉着梁将军的衣角，求他救救自己。<br>
原来，书生早已做鬼。他生前执迷于下棋，荒废了学业。家里打也打了，骂也骂了，可书生就是割舍不下。<br>
他把父亲活活气死，因“大不孝”的罪名被阎王索了性命，打入饿鬼狱。<br>
因他颇有才华，阎王又派他给东岳大帝的凤楼写碑文，如果写好了，可放他还阳。<br>
结果在前往凤楼的路上，书生巧遇梁将军的棋局，执念再起，耽误了行程。阎王知道后，任是谁来求情，都不再宽恕他。<br>
这两个故事告诉我们，<strong>无论是对物质的贪恋，还是对成就的追求，一旦成为执念，就会变成心灵的枷锁。</strong></p>
</blockquote>
<p>2025/02/21</p>
<p>不纠结过河的筏子</p>
<p>不迷恋肉身。既不迷恋自己的肉身，也不迷恋身边人的肉<br>
身。无论如何青春的肉体终会消逝，可以珍惜的时候就要好好珍惜，<br>
能够展现的时候就要尽情展现，不要等到肉身衰老，禽兽无能，眼前<br>
花盛开，鸟却飞不起来，才后悔莫及。  — 冯唐</p>
<p>2025/04/25</p>
<p>人生没有意义，它才自由，没意义不等于摆烂，什么都不做。</p>
<p>一朵花开在山里无人问津，另外一朵花被搬进奢华的房间，他们都还是花，一个活成了别人想要的样子，另一个无拘无束，活成了自己想要的样子 ——— 致人生的意义</p>
<p>空白才有无限可能！回归内心的空白，结果不是自我价值的终身判决。当你不需要意义证明自己时，反而变得更有力量，激发出更纯粹的创造力，不要沉迷于别人定义好的路，<br>
每个人有自己的路，不需要你去拯救或者批判，做好自己就好</p>
<p>2025/07/02</p>
<blockquote>
<p>“唐肃宗乾元年间，录事薛某高烧中梦见自己变成一条金色鲤鱼，几日不曾觅食，肚中甚是饥饿。此时，正遇一渔夫垂钓，他明知饵里有钩，却耐不住饵香扑鼻，张口吞饵，结果被渔翁钓了上来。” ————《醒世恒言》第26卷《薛录事鱼服证仙》</p>
</blockquote>
<p>欲望是处处都是陷阱。</p>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2025-01-01T09:58:42.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2025-01-01
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/%E6%91%98%E6%8A%84/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                摘抄
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="2" id="btn-2">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2024/12/31/2024%E6%91%98%E6%8A%84/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                2024摘抄
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-3">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <p><a href="https://xiaohu.ai/p/14455">采访当今最伟大的数学家对AI的看法 陶哲轩：我们正踏入数学的全新领域 – XiaoHu.AI学院</a></p>
<blockquote>
<p>我对重复人类已经擅长的事情并不感兴趣。这看起来效率低下。我认为在前沿领域，人类和AI将始终是必需的。它们有互补的优势。AI擅长将数十亿条数据转化为一个好的答案。人类擅长通过10次观察作出非常有创意的猜测。</p>
</blockquote>
<p>2024/10/22</p>
<p><strong>这是我们之间的故事，它代表的是一种特殊的意义（致不完美）</strong></p>
<p>2024/10/25</p>
<p><strong>王阳明曾说：“吾辈用功，只求日减，不求日增。减得一分人欲，便是复得一分天理，何等轻快洒脱，何等简易。</strong>”</p>
<p>我们应该定期清理卫生，只留下必需品，久而久之你就会发现，原来很多东西只是一个摆设，并非我们所需。</p>
<blockquote>
<p><strong>我们应该定期审视人生，这样才会发现，原来那些占据自己精力的东西，实际上毫无价值。</strong></p>
</blockquote>
<p>**都说人生从来不是加法，而是减法。**只有不断地抛弃一些不必要的东西，内心才不会被遮蔽，光照进来，才能看清自己内心真正需要的是什么。</p>
<p><strong>懂得知足，才能常乐</strong></p>
<p>欲望越膨胀，人类越得不到满足，这便是痛苦的根源。只有懂得知足，才能真正获得财富。</p>
<p>着相了</p>
<p><a href="https://m.baidu.com/from=844b/ssid=0/s?word=%E7%9D%80%E7%9B%B8&amp;sa=re_dqa_generate&amp;ms=1&amp;rqid=9536758797780036267&amp;params_ssrt=node-san">**着相</a>是一个‌<a href="https://m.baidu.com/from=844b/ssid=0/s?word=%E4%BD%9B%E6%95%99&amp;sa=re_dqa_generate&amp;ms=1&amp;rqid=9536758797780036267&amp;params_ssrt=node-san">佛教</a>术语，意思是执着于外相、虚相或个体意识而偏离了本质。**</p>
<p>2024/10/29</p>
<p><strong>事上练</strong></p>
<p>只有日常中多注意在事上的磨练，在各种事情上锻炼自己的应变能力，让自己心境逐渐处在一种十分稳定的状态下，只有这样才能锻炼出遇事不慌不乱的素质。</p>
<p>“熟能生巧，巧能生化”。在社会浮躁风气渐盛的今天，笃行恰恰是我们最应该学习的。</p>
<p><strong>笃行</strong></p>
<p>王阳明有句话：“辨即明矣，思既慎矣，问既审矣，学既能矣，又从而不息其功焉，斯之谓笃行。”意思是，当我们已经分辨清楚，思考缜密，问得详细，已经学会了，还是持续不断地用功，这就叫笃行，这是获得成功的必要前提。</p>
<p>2024/10/30</p>
<p><strong>君子得失淡然，所以有终身之乐；小人患得患失，所以无一日之乐。</strong></p>
<p>2024/11/7</p>
<p><strong>淡定看人生，宁静做自我。</strong></p>
<p><strong>所谓定力，实为定心，心静了，生活自然也就安稳了，人生自然也就安定了。</strong></p>
<p>反之，无法保持内心的宁静，则容易被情绪所控制，稍不注意就可能误入歧途、贻误终生。</p>
<p><strong>忍一时风平浪静，退一步海阔天空。想开了，自然微笑；看透了，肯定放下。这样才能在“风雨人生路上，逍遥任我行。”</strong></p>
<p>2024/11/12</p>
<p>第一性原理（First Principles Thinking）是一种思维方法，指的是把问题分解到最基本的真理上，从最基本的层面去思考问题，而不是基于类比或现有经验。</p>
<p>让我用一个简单的编程例子来说明：假设我们需要计算一个购物车的总价格。</p>
<p><strong>传统思维方式</strong></p>
<p>：直接参考其他电商网站的实现方式，复制他们的解决方案。</p>
<p><strong>第一性原理思维</strong></p>
<p>：</p>
<ul>
<li>首先分析问题的本质：</li>
<li>购物车是什么？ → 商品的集合</li>
<li>总价格是什么？ → 所有商品价格的总和</li>
<li>每个商品的价格如何计算？ → 单价 × 数量</li>
</ul>
<ol start="2">
<li>基于这些基本事实来设计解决方案：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CartItem</span>:</span><br><span class="line">    def <span class="title function_">__init__</span><span class="params">(self, name, price, quantity)</span>:</span><br><span class="line">        self.name = name</span><br><span class="line">        self.price = price</span><br><span class="line">        self.quantity = quantity</span><br><span class="line">    </span><br><span class="line">    def <span class="title function_">get_total</span><span class="params">(self)</span>:</span><br><span class="line">        <span class="keyword">return</span> self.price * self.quantity</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShoppingCart</span>:</span><br><span class="line">    def <span class="title function_">__init__</span><span class="params">(self)</span>:</span><br><span class="line">        self.items = []</span><br><span class="line">    </span><br><span class="line">    def <span class="title function_">add_item</span><span class="params">(self, item)</span>:</span><br><span class="line">        self.items.append(item)</span><br><span class="line">    </span><br><span class="line">    def <span class="title function_">calculate_total</span><span class="params">(self)</span>:</span><br><span class="line">        <span class="keyword">return</span> sum(item.get_total() <span class="keyword">for</span> item in self.items)</span><br></pre></td></tr></table></figure>
<p>通过第一性原理思维，我们：</p>
<ul>
<li>没有直接抄袭现有解决方案</li>
<li>从最基本的概念出发（商品、数量、价格）</li>
<li>构建出了清晰、可维护的解决方案</li>
</ul>
<p>这种思维方式让我们能够：</p>
<ul>
<li>更深入地理解问题</li>
<li>创造出更优的解决方案</li>
<li>避免被既有思维定式限制</li>
</ul>
<p>马斯克就经常使用第一性原理思维。比如在设计特斯拉电池时，他没有直接采用现有的电池方案，而是从最基本的材料成本和物理原理出发，重新思考了电池的设计，最终降低了成本并提高了性能。</p>
<p>2024/11/17</p>
<p>非淡泊无以明志，非宁静无以致远 —诸葛亮《诫子书》</p>
<p>2024/12/10</p>
<p>立志、勤学、改过、责善</p>
<p>为什么立志如此重要？王阳明举例说，一个人如果没有志向，那么就好像船没有舵木、马没有衔环，于是只能随波逐流，人生就如一盘散沙。</p>
<p>非学无以广才，非志无以成学</p>
<p>如果不通过学习，就无法增长才干；如果没有志向，就无法成就学问。</p>
<p>2024/12/26</p>
<p>如何才能做到在工作和生活中诚意满满？<br>
第一，搞清楚你的工作性质：这份工作到底是在做什么？它能给别人带来什么益处？<br>
第二，紧盯着那个“益处”，并且专心致志地放大它。<br>
第三，把工作和生活紧密结合，真心实意地对待你的工作和生活。</p>
<p>2024/12/27</p>
<p>每天前进三十公里 ——南极探险的故事</p>
<p>2024/12/29</p>
<p>人生在世，不是每日往复，应该想想来到这个世间的道理？ 寻求自己的答案</p>
<p>《穷爸爸也富爸爸》普通人只能被日复一日推着走</p>
<p>被金钱支配的恐惧和欲望</p>
<p>金钱的本质是流动</p>
<p>不要为钱打工，要让钱为你打工</p>
<p><strong>首先要思考上班的意思是什么？上班是为了赚钱？那赚钱的方式只有上班吗？上班时最优解吗？还是说上班只是当下临时方案？</strong></p>
<p>2024/12/31</p>
<p>人活一世，到底为了什么？是为了功名利禄、权势尊位，还是传宗接代、子孙满堂？</p>
<p><strong>王阳明说，是为了心安。而心安的唯一来源便是人与生俱来的良知。除却良知，一切都是梦幻泡影。</strong></p>
<p>一个杯子，里面有半杯水。有人描述这杯中还有半杯水，而有人会说这里只有半杯水了。前者是乐观主义者，后者是悲观主义者。<br>
有句话叫“悲观者往往正确，乐观者往往成功”。大意是说，悲观者意识到一件事的成功率不高时，就会拒绝行动，从概率角度来看，这是正确的。但乐观者往往会关注事物积极的一方面，即使意识到一件事的成功率不高，只要回报足够，也倾向于迎难而上；不管多难的事，只要有所实践，离成功便更近一步，再加上点儿运气及坚持到底的乐观心态，往往就成功了</p>
<p>此心安处是吾乡，心安才是良知！</p>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-3">
                                        <div class="post-content" data-content-type="full">
                                            <p><a href="https://xiaohu.ai/p/14455">采访当今最伟大的数学家对AI的看法 陶哲轩：我们正踏入数学的全新领域 – XiaoHu.AI学院</a></p>
<blockquote>
<p>我对重复人类已经擅长的事情并不感兴趣。这看起来效率低下。我认为在前沿领域，人类和AI将始终是必需的。它们有互补的优势。AI擅长将数十亿条数据转化为一个好的答案。人类擅长通过10次观察作出非常有创意的猜测。</p>
</blockquote>
<p>2024/10/22</p>
<p><strong>这是我们之间的故事，它代表的是一种特殊的意义（致不完美）</strong></p>
<p>2024/10/25</p>
<p><strong>王阳明曾说：“吾辈用功，只求日减，不求日增。减得一分人欲，便是复得一分天理，何等轻快洒脱，何等简易。</strong>”</p>
<p>我们应该定期清理卫生，只留下必需品，久而久之你就会发现，原来很多东西只是一个摆设，并非我们所需。</p>
<blockquote>
<p><strong>我们应该定期审视人生，这样才会发现，原来那些占据自己精力的东西，实际上毫无价值。</strong></p>
</blockquote>
<p>**都说人生从来不是加法，而是减法。**只有不断地抛弃一些不必要的东西，内心才不会被遮蔽，光照进来，才能看清自己内心真正需要的是什么。</p>
<p><strong>懂得知足，才能常乐</strong></p>
<p>欲望越膨胀，人类越得不到满足，这便是痛苦的根源。只有懂得知足，才能真正获得财富。</p>
<p>着相了</p>
<p><a href="https://m.baidu.com/from=844b/ssid=0/s?word=%E7%9D%80%E7%9B%B8&amp;sa=re_dqa_generate&amp;ms=1&amp;rqid=9536758797780036267&amp;params_ssrt=node-san">**着相</a>是一个‌<a href="https://m.baidu.com/from=844b/ssid=0/s?word=%E4%BD%9B%E6%95%99&amp;sa=re_dqa_generate&amp;ms=1&amp;rqid=9536758797780036267&amp;params_ssrt=node-san">佛教</a>术语，意思是执着于外相、虚相或个体意识而偏离了本质。**</p>
<p>2024/10/29</p>
<p><strong>事上练</strong></p>
<p>只有日常中多注意在事上的磨练，在各种事情上锻炼自己的应变能力，让自己心境逐渐处在一种十分稳定的状态下，只有这样才能锻炼出遇事不慌不乱的素质。</p>
<p>“熟能生巧，巧能生化”。在社会浮躁风气渐盛的今天，笃行恰恰是我们最应该学习的。</p>
<p><strong>笃行</strong></p>
<p>王阳明有句话：“辨即明矣，思既慎矣，问既审矣，学既能矣，又从而不息其功焉，斯之谓笃行。”意思是，当我们已经分辨清楚，思考缜密，问得详细，已经学会了，还是持续不断地用功，这就叫笃行，这是获得成功的必要前提。</p>
<p>2024/10/30</p>
<p><strong>君子得失淡然，所以有终身之乐；小人患得患失，所以无一日之乐。</strong></p>
<p>2024/11/7</p>
<p><strong>淡定看人生，宁静做自我。</strong></p>
<p><strong>所谓定力，实为定心，心静了，生活自然也就安稳了，人生自然也就安定了。</strong></p>
<p>反之，无法保持内心的宁静，则容易被情绪所控制，稍不注意就可能误入歧途、贻误终生。</p>
<p><strong>忍一时风平浪静，退一步海阔天空。想开了，自然微笑；看透了，肯定放下。这样才能在“风雨人生路上，逍遥任我行。”</strong></p>
<p>2024/11/12</p>
<p>第一性原理（First Principles Thinking）是一种思维方法，指的是把问题分解到最基本的真理上，从最基本的层面去思考问题，而不是基于类比或现有经验。</p>
<p>让我用一个简单的编程例子来说明：假设我们需要计算一个购物车的总价格。</p>
<p><strong>传统思维方式</strong></p>
<p>：直接参考其他电商网站的实现方式，复制他们的解决方案。</p>
<p><strong>第一性原理思维</strong></p>
<p>：</p>
<ul>
<li>首先分析问题的本质：</li>
<li>购物车是什么？ → 商品的集合</li>
<li>总价格是什么？ → 所有商品价格的总和</li>
<li>每个商品的价格如何计算？ → 单价 × 数量</li>
</ul>
<ol start="2">
<li>基于这些基本事实来设计解决方案：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CartItem</span>:</span><br><span class="line">    def <span class="title function_">__init__</span><span class="params">(self, name, price, quantity)</span>:</span><br><span class="line">        self.name = name</span><br><span class="line">        self.price = price</span><br><span class="line">        self.quantity = quantity</span><br><span class="line">    </span><br><span class="line">    def <span class="title function_">get_total</span><span class="params">(self)</span>:</span><br><span class="line">        <span class="keyword">return</span> self.price * self.quantity</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShoppingCart</span>:</span><br><span class="line">    def <span class="title function_">__init__</span><span class="params">(self)</span>:</span><br><span class="line">        self.items = []</span><br><span class="line">    </span><br><span class="line">    def <span class="title function_">add_item</span><span class="params">(self, item)</span>:</span><br><span class="line">        self.items.append(item)</span><br><span class="line">    </span><br><span class="line">    def <span class="title function_">calculate_total</span><span class="params">(self)</span>:</span><br><span class="line">        <span class="keyword">return</span> sum(item.get_total() <span class="keyword">for</span> item in self.items)</span><br></pre></td></tr></table></figure>
<p>通过第一性原理思维，我们：</p>
<ul>
<li>没有直接抄袭现有解决方案</li>
<li>从最基本的概念出发（商品、数量、价格）</li>
<li>构建出了清晰、可维护的解决方案</li>
</ul>
<p>这种思维方式让我们能够：</p>
<ul>
<li>更深入地理解问题</li>
<li>创造出更优的解决方案</li>
<li>避免被既有思维定式限制</li>
</ul>
<p>马斯克就经常使用第一性原理思维。比如在设计特斯拉电池时，他没有直接采用现有的电池方案，而是从最基本的材料成本和物理原理出发，重新思考了电池的设计，最终降低了成本并提高了性能。</p>
<p>2024/11/17</p>
<p>非淡泊无以明志，非宁静无以致远 —诸葛亮《诫子书》</p>
<p>2024/12/10</p>
<p>立志、勤学、改过、责善</p>
<p>为什么立志如此重要？王阳明举例说，一个人如果没有志向，那么就好像船没有舵木、马没有衔环，于是只能随波逐流，人生就如一盘散沙。</p>
<p>非学无以广才，非志无以成学</p>
<p>如果不通过学习，就无法增长才干；如果没有志向，就无法成就学问。</p>
<p>2024/12/26</p>
<p>如何才能做到在工作和生活中诚意满满？<br>
第一，搞清楚你的工作性质：这份工作到底是在做什么？它能给别人带来什么益处？<br>
第二，紧盯着那个“益处”，并且专心致志地放大它。<br>
第三，把工作和生活紧密结合，真心实意地对待你的工作和生活。</p>
<p>2024/12/27</p>
<p>每天前进三十公里 ——南极探险的故事</p>
<p>2024/12/29</p>
<p>人生在世，不是每日往复，应该想想来到这个世间的道理？ 寻求自己的答案</p>
<p>《穷爸爸也富爸爸》普通人只能被日复一日推着走</p>
<p>被金钱支配的恐惧和欲望</p>
<p>金钱的本质是流动</p>
<p>不要为钱打工，要让钱为你打工</p>
<p><strong>首先要思考上班的意思是什么？上班是为了赚钱？那赚钱的方式只有上班吗？上班时最优解吗？还是说上班只是当下临时方案？</strong></p>
<p>2024/12/31</p>
<p>人活一世，到底为了什么？是为了功名利禄、权势尊位，还是传宗接代、子孙满堂？</p>
<p><strong>王阳明说，是为了心安。而心安的唯一来源便是人与生俱来的良知。除却良知，一切都是梦幻泡影。</strong></p>
<p>一个杯子，里面有半杯水。有人描述这杯中还有半杯水，而有人会说这里只有半杯水了。前者是乐观主义者，后者是悲观主义者。<br>
有句话叫“悲观者往往正确，乐观者往往成功”。大意是说，悲观者意识到一件事的成功率不高时，就会拒绝行动，从概率角度来看，这是正确的。但乐观者往往会关注事物积极的一方面，即使意识到一件事的成功率不高，只要回报足够，也倾向于迎难而上；不管多难的事，只要有所实践，离成功便更近一步，再加上点儿运气及坚持到底的乐观心态，往往就成功了</p>
<p>此心安处是吾乡，心安才是良知！</p>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2024-12-31T09:55:20.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2024-12-31
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/%E6%91%98%E6%8A%84/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                摘抄
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="3" id="btn-3">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2022/06/12/%E4%BA%8B%E5%8A%A1%E5%88%B0%E5%BA%95%E6%98%AF%E9%9A%94%E7%A6%BB%E7%9A%84%E8%BF%98%E6%98%AF%E4%B8%8D%E9%9A%94%E7%A6%BB%E7%9A%84%EF%BC%9F/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                事务到底是隔离的还是不隔离的？
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-4">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <p><code>begin/start transaction</code>命令并不是一个事务的起点，在执行到它们之后的第一个操作InnoDB表的语句，事务才真正启动。使用<code>start transation with consistent snapshot </code>这个命令可以马上启动一个事务。</p>
<p><strong>在MySQL中有两个视图的概念：</strong></p>
<ul>
<li>
<p>一个是view。它是一个用于查询语句定义的虚拟表，它的语法是：<code>create view ...</code>。</p>
</li>
<li>
<p>另一个是InnoDB 在实现MVCC时用到的一致性<strong>读视图</strong>，即 consistent read view，用于支持RC（Read Commit 读提交）和RR（Repeatable 可重复读）隔离级别实现的。</p>
</li>
</ul>
<h2 id="“快照”在-MVCC-里是怎么工作的？">“快照”在 MVCC 里是怎么工作的？</h2>
<p>在可重复读隔离级别下，事务在启动的时候就“拍个快照”，这个快照时基于整库的。</p>
<blockquote>
<p>如果库有100G，那么启动一个事务就需要拷贝100G数据，这样实现是不现实的。</p>
</blockquote>
<h3 id="快照是怎么实现的？">快照是怎么实现的？</h3>
<p>InnoDB 里面每个事务都有一个唯一的事务ID，叫做transaction id，它是在事务开始的时候向InnoDB 的事务系统申请的，<strong>是按照顺序严格递增的。</strong></p>
<p>而每行数据也都是有多个版本的。每次事务更新数据的时候，都会生成一个新的数据版本，并且把 transaction id 赋值给这个数据版本的事务 ID，记为 row trx_id。同时，旧的数据版本要保留，并且在新的数据版本中，能够有信息可以直接拿到它。</p>
<p>也就是说，数据表中的一行记录，其实可能有多个版本 (row)，每个版本有自己的 row trx_id。</p>
<p>如图下所示，就是一个记录被多个事务连续更新后的状态。<br>
<img src="http://qiniu.deveye.cn/blog/img/20220615111955.png" alt=""></p>
<p>图中的三个虚线箭头，就是undo log；而 V1、V2、V3 并不是物理上真实存在的，而是每次需要的时候根据当前版本和 undo log 计算出来的。比如，需要 V2 的时候，就是通过 V4 依次执行 U3、U2 算出来。</p>
<p><strong>事务启动的时候，以启动的时刻为准，如果一个数据版本低于在事务启动之前生成的，那就可见，如果在启动之后才生成的，那就不可见。</strong></p>
<p>在实现上，InnoDB为每个事务构造了一个数据，用来保存这个事务的启动瞬间，当前正在“活跃”的所有事务ID，“活跃”指的是，启动了但还没提交。</p>
<p>数组里面事务 ID 的最小值记为低水位，当前系统里面已经创建过的事务 ID 的最大值加 1 记为高水位。</p>
<p>这个视图数组和高水位，就组成了当前事务的一致性视图（read-view）。</p>
<p><img src="http://qiniu.deveye.cn/blog/img/20220615113104.png" alt=""></p>
<p>这样，对于当前事务的启动瞬间来说，一个数据版本的 row trx_id，有以下几种可能：</p>
<ol>
<li>
<p>如果落在绿色部分，表示这个版本是已提交的事务或者是当前事务自己生成的，这个数据是可见的；</p>
</li>
<li>
<p>如果落在红色部分，表示这个版本是由将来启动的事务生成的，是肯定不可见的；</p>
</li>
<li>
<p>如果落在黄色部分，那就包括两种情况<br>
a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>
b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。</p>
</li>
</ol>
<p>** InnoDB 利用了“所有数据都有多个版本”的这个特性，实现了“秒级创建快照”的能力。**</p>
<h2 id="更新逻辑">更新逻辑</h2>
<p><strong>更新数据都是先读后写的，而这个读，只能读当前的值，称为“当前读”（current read）。</strong></p>
<p>当前读，<strong>读取的是最新版本</strong>，并且需要先获取对应记录的锁，如以下这些 SQL 类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select ... lock in share mode</span><br><span class="line"></span><br><span class="line">select ... for update</span><br><span class="line"></span><br><span class="line">update 、delete 、insert</span><br></pre></td></tr></table></figure>
<p>例如，要 update 一条记录，在事务执行过程中，如果不加锁，那么另一个事务可以 delete 这条数据并且能成功 commit ，就会产生冲突了。所以 update 的时候肯定要是当前读，得到最新的信息并且锁定相应的记录。</p>
<h2 id="事务的可重复读的能力是怎么实现的？">事务的可重复读的能力是怎么实现的？</h2>
<p>可重复读的核心就是一致性读（consistent read）；而事务更新数据的时候，只能用当前读。如果当前的记录的行锁被其他事务占用的话，就需要进入锁等待。</p>
<p>而读提交的逻辑和可重复读的逻辑类似，它们最主要的区别是：</p>
<ul>
<li>
<p>在可重复读隔离级别下，只需要在事务开始的时候创建一致性视图，之后事务里的其他查询都共用这个一致性视图；</p>
</li>
<li>
<p>在读提交隔离级别下，每一个语句执行前都会重新算出一个新的视图。</p>
</li>
</ul>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-4">
                                        <div class="post-content" data-content-type="full">
                                            <p><code>begin/start transaction</code>命令并不是一个事务的起点，在执行到它们之后的第一个操作InnoDB表的语句，事务才真正启动。使用<code>start transation with consistent snapshot </code>这个命令可以马上启动一个事务。</p>
<p><strong>在MySQL中有两个视图的概念：</strong></p>
<ul>
<li>
<p>一个是view。它是一个用于查询语句定义的虚拟表，它的语法是：<code>create view ...</code>。</p>
</li>
<li>
<p>另一个是InnoDB 在实现MVCC时用到的一致性<strong>读视图</strong>，即 consistent read view，用于支持RC（Read Commit 读提交）和RR（Repeatable 可重复读）隔离级别实现的。</p>
</li>
</ul>
<h2 id="“快照”在-MVCC-里是怎么工作的？">“快照”在 MVCC 里是怎么工作的？</h2>
<p>在可重复读隔离级别下，事务在启动的时候就“拍个快照”，这个快照时基于整库的。</p>
<blockquote>
<p>如果库有100G，那么启动一个事务就需要拷贝100G数据，这样实现是不现实的。</p>
</blockquote>
<h3 id="快照是怎么实现的？">快照是怎么实现的？</h3>
<p>InnoDB 里面每个事务都有一个唯一的事务ID，叫做transaction id，它是在事务开始的时候向InnoDB 的事务系统申请的，<strong>是按照顺序严格递增的。</strong></p>
<p>而每行数据也都是有多个版本的。每次事务更新数据的时候，都会生成一个新的数据版本，并且把 transaction id 赋值给这个数据版本的事务 ID，记为 row trx_id。同时，旧的数据版本要保留，并且在新的数据版本中，能够有信息可以直接拿到它。</p>
<p>也就是说，数据表中的一行记录，其实可能有多个版本 (row)，每个版本有自己的 row trx_id。</p>
<p>如图下所示，就是一个记录被多个事务连续更新后的状态。<br>
<img src="http://qiniu.deveye.cn/blog/img/20220615111955.png" alt=""></p>
<p>图中的三个虚线箭头，就是undo log；而 V1、V2、V3 并不是物理上真实存在的，而是每次需要的时候根据当前版本和 undo log 计算出来的。比如，需要 V2 的时候，就是通过 V4 依次执行 U3、U2 算出来。</p>
<p><strong>事务启动的时候，以启动的时刻为准，如果一个数据版本低于在事务启动之前生成的，那就可见，如果在启动之后才生成的，那就不可见。</strong></p>
<p>在实现上，InnoDB为每个事务构造了一个数据，用来保存这个事务的启动瞬间，当前正在“活跃”的所有事务ID，“活跃”指的是，启动了但还没提交。</p>
<p>数组里面事务 ID 的最小值记为低水位，当前系统里面已经创建过的事务 ID 的最大值加 1 记为高水位。</p>
<p>这个视图数组和高水位，就组成了当前事务的一致性视图（read-view）。</p>
<p><img src="http://qiniu.deveye.cn/blog/img/20220615113104.png" alt=""></p>
<p>这样，对于当前事务的启动瞬间来说，一个数据版本的 row trx_id，有以下几种可能：</p>
<ol>
<li>
<p>如果落在绿色部分，表示这个版本是已提交的事务或者是当前事务自己生成的，这个数据是可见的；</p>
</li>
<li>
<p>如果落在红色部分，表示这个版本是由将来启动的事务生成的，是肯定不可见的；</p>
</li>
<li>
<p>如果落在黄色部分，那就包括两种情况<br>
a. 若 row trx_id 在数组中，表示这个版本是由还没提交的事务生成的，不可见；<br>
b. 若 row trx_id 不在数组中，表示这个版本是已经提交了的事务生成的，可见。</p>
</li>
</ol>
<p>** InnoDB 利用了“所有数据都有多个版本”的这个特性，实现了“秒级创建快照”的能力。**</p>
<h2 id="更新逻辑">更新逻辑</h2>
<p><strong>更新数据都是先读后写的，而这个读，只能读当前的值，称为“当前读”（current read）。</strong></p>
<p>当前读，<strong>读取的是最新版本</strong>，并且需要先获取对应记录的锁，如以下这些 SQL 类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select ... lock in share mode</span><br><span class="line"></span><br><span class="line">select ... for update</span><br><span class="line"></span><br><span class="line">update 、delete 、insert</span><br></pre></td></tr></table></figure>
<p>例如，要 update 一条记录，在事务执行过程中，如果不加锁，那么另一个事务可以 delete 这条数据并且能成功 commit ，就会产生冲突了。所以 update 的时候肯定要是当前读，得到最新的信息并且锁定相应的记录。</p>
<h2 id="事务的可重复读的能力是怎么实现的？">事务的可重复读的能力是怎么实现的？</h2>
<p>可重复读的核心就是一致性读（consistent read）；而事务更新数据的时候，只能用当前读。如果当前的记录的行锁被其他事务占用的话，就需要进入锁等待。</p>
<p>而读提交的逻辑和可重复读的逻辑类似，它们最主要的区别是：</p>
<ul>
<li>
<p>在可重复读隔离级别下，只需要在事务开始的时候创建一致性视图，之后事务里的其他查询都共用这个一致性视图；</p>
</li>
<li>
<p>在读提交隔离级别下，每一个语句执行前都会重新算出一个新的视图。</p>
</li>
</ul>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2022-06-12T03:04:00.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2022-06-12
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                MySQL实战45讲
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="4" id="btn-4">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2022/06/12/%E8%A1%8C%E9%94%81%E5%8A%9F%E8%BF%87%EF%BC%9A%E6%80%8E%E4%B9%88%E5%87%8F%E5%B0%91%E8%A1%8C%E9%94%81%E5%AF%B9%E6%80%A7%E8%83%BD%E7%9A%84%E5%BD%B1%E5%93%8D%EF%BC%9F/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                行锁功过：怎么减少行锁对性能的影响？
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-5">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <h2 id="从两阶段锁说起">从两阶段锁说起</h2>
<p><img src="http://qiniu.deveye.cn/blog/img/20220614094047.png" alt=""></p>
<p>实际上事务B的update语句会被阻塞，直至事务A执行commit之后，事务B才能继续执行。</p>
<p><strong>在InnoDB事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是等到事务结束才释放，这就是两阶段锁协议。</strong></p>
<blockquote>
<p>如果你的事务中需要锁多个行，要把最可能造成冲突、最可能影响并发的锁尽量往后放。</p>
</blockquote>
<h2 id="死锁和死锁检测">死锁和死锁检测</h2>
<p>当并发系统出现资源循环依赖，就会导致这几个线程处于无限等待状态，称为<strong>死锁</strong>。</p>
<p><img src="http://qiniu.deveye.cn/blog/img/20220614095944.png" alt=""></p>
<p>两种解决死锁的策略：</p>
<ul>
<li>
<p>一种策略是直接进入等待，直至超时。这个超时时间可以通过参数<code>innodb_lock_wait_timeout</code>来设置。</p>
</li>
<li>
<p>另外一种策略是发起死锁检测，发现死锁后，主动回滚死锁链条中的某一个事务，让其他事务得以继续执行。将参数<code>innodb_deadlock_detect</code>设置为on，表示开启这个逻辑。</p>
</li>
</ul>
<blockquote>
<p>使用<code>show variables like 'innodb_deadlock_detect';</code>可以查看系统参数。</p>
</blockquote>
<h2 id="问题">问题</h2>
<p>如果你要删除一个表里面的前 10000 行数据，有以下三种方法可以做到：</p>
<ul>
<li>
<p>第一种，直接执行 delete from T limit 10000;</p>
</li>
<li>
<p>第二种，在一个连接中循环执行 20 次 delete from T limit 500;</p>
</li>
<li>
<p>第三种，在 20 个连接中同时执行 delete from T limit 500。</p>
</li>
</ul>
<p>一般会选择第二种。</p>
<p>第一种方式单个语句占用时间长，锁的时间也比较长；而且大事务还会导致主从延迟。</p>
<p>第三种方式会人为造成锁冲突。</p>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-5">
                                        <div class="post-content" data-content-type="full">
                                            <h2 id="从两阶段锁说起">从两阶段锁说起</h2>
<p><img src="http://qiniu.deveye.cn/blog/img/20220614094047.png" alt=""></p>
<p>实际上事务B的update语句会被阻塞，直至事务A执行commit之后，事务B才能继续执行。</p>
<p><strong>在InnoDB事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是等到事务结束才释放，这就是两阶段锁协议。</strong></p>
<blockquote>
<p>如果你的事务中需要锁多个行，要把最可能造成冲突、最可能影响并发的锁尽量往后放。</p>
</blockquote>
<h2 id="死锁和死锁检测">死锁和死锁检测</h2>
<p>当并发系统出现资源循环依赖，就会导致这几个线程处于无限等待状态，称为<strong>死锁</strong>。</p>
<p><img src="http://qiniu.deveye.cn/blog/img/20220614095944.png" alt=""></p>
<p>两种解决死锁的策略：</p>
<ul>
<li>
<p>一种策略是直接进入等待，直至超时。这个超时时间可以通过参数<code>innodb_lock_wait_timeout</code>来设置。</p>
</li>
<li>
<p>另外一种策略是发起死锁检测，发现死锁后，主动回滚死锁链条中的某一个事务，让其他事务得以继续执行。将参数<code>innodb_deadlock_detect</code>设置为on，表示开启这个逻辑。</p>
</li>
</ul>
<blockquote>
<p>使用<code>show variables like 'innodb_deadlock_detect';</code>可以查看系统参数。</p>
</blockquote>
<h2 id="问题">问题</h2>
<p>如果你要删除一个表里面的前 10000 行数据，有以下三种方法可以做到：</p>
<ul>
<li>
<p>第一种，直接执行 delete from T limit 10000;</p>
</li>
<li>
<p>第二种，在一个连接中循环执行 20 次 delete from T limit 500;</p>
</li>
<li>
<p>第三种，在 20 个连接中同时执行 delete from T limit 500。</p>
</li>
</ul>
<p>一般会选择第二种。</p>
<p>第一种方式单个语句占用时间长，锁的时间也比较长；而且大事务还会导致主从延迟。</p>
<p>第三种方式会人为造成锁冲突。</p>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2022-06-12T01:39:51.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2022-06-12
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                MySQL实战45讲
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="5" id="btn-5">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2022/06/08/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E7%B4%A2%E5%BC%95%EF%BC%88%E4%B8%8B%EF%BC%89/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                深入浅出索引（下）
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-6">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <h2 id="覆盖索引">覆盖索引</h2>
<p>如果执行语句如:<code>select ID from T where k between 3 and 5</code>，这是只需要查ID的值，而ID的值已经在k索引树上了，因此可以直接提供查询结果，不需要回表，这种情况我们称为<strong>覆盖索引</strong>。</p>
<p><strong>由于覆盖索引可以减少树的搜索次数，显著提升查询性能，所以使用覆盖索引是一个常用的性能优化手段。</strong></p>
<h2 id="最左前缀原则">最左前缀原则</h2>
<p><img src="http://qiniu.deveye.cn/blog/img/20220608105848.png" alt=""><br>
可以看到，索引是按照索引定义里面出现的字段排序的。</p>
<p>只要满足最左前缀，就可以利用索引来加速检索。这个最左前缀可以是联合索引的最左 N 个字段，也可以是字符串索引的最左 M 个字符。</p>
<h3 id="在建立联合索引的时候，如何安排索引内的字段顺序">在建立联合索引的时候，如何安排索引内的字段顺序?</h3>
<p>第一原则是，如果通过调整顺序，可以少维护一个索引，那么这个顺序往往就是需要优先考虑采用的。</p>
<h2 id="索引下推">索引下推</h2>
<p>MySQL 5.6 引入的索引下推优化（index condition pushdown)， 可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。</p>
<p>例如以下查询语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tuser where name like &#x27;张 %&#x27; and age=10 and ismale=1;</span><br></pre></td></tr></table></figure>
<center>无索引下推</center>
<p><img src="http://qiniu.deveye.cn/blog/img/20220608110650.png" alt=""></p>
<center>有索引下推</center>
<p><img src="http://qiniu.deveye.cn/blog/img/20220608110743.png" alt=""></p>
<p>可以明显的看出，有索引下推的情况下减少了回表的次数。</p>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-6">
                                        <div class="post-content" data-content-type="full">
                                            <h2 id="覆盖索引">覆盖索引</h2>
<p>如果执行语句如:<code>select ID from T where k between 3 and 5</code>，这是只需要查ID的值，而ID的值已经在k索引树上了，因此可以直接提供查询结果，不需要回表，这种情况我们称为<strong>覆盖索引</strong>。</p>
<p><strong>由于覆盖索引可以减少树的搜索次数，显著提升查询性能，所以使用覆盖索引是一个常用的性能优化手段。</strong></p>
<h2 id="最左前缀原则">最左前缀原则</h2>
<p><img src="http://qiniu.deveye.cn/blog/img/20220608105848.png" alt=""><br>
可以看到，索引是按照索引定义里面出现的字段排序的。</p>
<p>只要满足最左前缀，就可以利用索引来加速检索。这个最左前缀可以是联合索引的最左 N 个字段，也可以是字符串索引的最左 M 个字符。</p>
<h3 id="在建立联合索引的时候，如何安排索引内的字段顺序">在建立联合索引的时候，如何安排索引内的字段顺序?</h3>
<p>第一原则是，如果通过调整顺序，可以少维护一个索引，那么这个顺序往往就是需要优先考虑采用的。</p>
<h2 id="索引下推">索引下推</h2>
<p>MySQL 5.6 引入的索引下推优化（index condition pushdown)， 可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。</p>
<p>例如以下查询语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tuser where name like &#x27;张 %&#x27; and age=10 and ismale=1;</span><br></pre></td></tr></table></figure>
<center>无索引下推</center>
<p><img src="http://qiniu.deveye.cn/blog/img/20220608110650.png" alt=""></p>
<center>有索引下推</center>
<p><img src="http://qiniu.deveye.cn/blog/img/20220608110743.png" alt=""></p>
<p>可以明显的看出，有索引下推的情况下减少了回表的次数。</p>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2022-06-08T01:49:05.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2022-06-08
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                MySQL实战45讲
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="6" id="btn-6">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2022/06/07/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E7%B4%A2%E5%BC%95%EF%BC%88%E4%B8%8A%EF%BC%89/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                深入浅出索引（上）
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-7">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <p><strong>索引的出现其实就是为了提高数据查询的效率，就像书的目录一样。</strong></p>
<h2 id="索引常见模型">索引常见模型</h2>
<h3 id="哈希表">哈希表</h3>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607160718.png" alt=""></p>
<p>哈希表是一种以键值对存储的数据结构，只要输入key，就可以根据key找到对应的vaule。不可避免的是会存在hash冲突，处理这种情况方法是拉出一个链表。（类比Java中HashMap结构）。</p>
<p>优点：</p>
<ul>
<li>查找速度快，新增速度也快。</li>
</ul>
<p>缺点：</p>
<ul>
<li>因为不是有序的，如果需要范围查询，速度是很慢的。</li>
</ul>
<p>哈希表这种结构适用于只有等值查询的场景，比如 Memcached 及其他一些 NoSQL 引擎。</p>
<h3 id="有序数组">有序数组</h3>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607160727.png" alt=""></p>
<p>有序数组查询时，可以使用二分法进行搜索，时间复杂度是O(log(N))，并且有序数据还支持范围查询。但是需要插入的时候，就需要进行数据挪动（因为要保证顺序），成本是非常高的。</p>
<p>因此，<strong>有序数组索引只适用于静态存储引擎</strong>。</p>
<h3 id="搜索树">搜索树</h3>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607160741.png" alt=""></p>
<p>二叉树的特点是：每个节点的左儿子小于父节点，父节点又小于右儿子。这样如果你要查 ID_card_n2 的话，按照图中的搜索顺序就是按照 UserA -&gt; UserC -&gt; UserF -&gt; User2 这个路径得到。这个时间复杂度是 O(log(N))。</p>
<p>当然为了维持 O(log(N)) 的查询复杂度，你就需要保持这棵树是平衡二叉树。为了做这个保证，更新的时间复杂度也是 O(log(N))。</p>
<p>二叉树的主要缺点是：当数据量很大的时候，树高会非常高，假如树高为20。一次查询可能需要访问 20 个数据块。在机械硬盘时代，从磁盘随机读一个数据块需要 10 ms 左右的寻址时间。也就是说，对于一个 100 万行的表，如果使用二叉树来存储，单独访问一个行可能需要 20 个 10 ms 的时间，这个查询可真够慢的。</p>
<h2 id="InnoDB-的索引模型">InnoDB 的索引模型</h2>
<p>在InnoDB中，表都是根据主键顺序以索引的形式存放的，这种存储方式的表称为索引组织表。<strong>InnoDB使用的是B+树索引模型</strong>，所以数据都是存储在B+树中的。</p>
<p><strong>每一个索引在InnoDB中对应一颗B+树。</strong></p>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607162535.png" alt=""></p>
<p>从上图来看，索引类型分为：主键索引和非主键索引。</p>
<p><strong>主键索引在InnoDB中也成为聚簇索引（clustered index），非主键索引在InnoDB中成为二级索引（secondary index）。</strong></p>
<h3 id="基于主键索引和非主键索引搜索的区别：">基于主键索引和非主键索引搜索的区别：</h3>
<ul>
<li>
<p>基于主键索引查询只需要搜索对应的这颗B+树。</p>
</li>
<li>
<p>基于非主键索引首先先查到对应值的ID（假设ID为主键），再到ID索引树中搜索一次，这个过程称为回表。</p>
</li>
</ul>
<h2 id="索引的维护">索引的维护</h2>
<h3 id="页分裂">页分裂</h3>
<p>B+ 树为了维护索引的有序性，在插入新值的时候需要做必要的维护，如果插入的数据需要在页的中间，那么就需要进行数据的挪动，空出位置，如果插入的页刚好满了，就会触发<strong>页分裂</strong>，页分裂除了会影响性能，而且会使整体空间利用率降低50%（因为之前一个页，分裂成了两个）。</p>
<p>当然有分裂就有合并。当相邻两个页由于删除了数据，利用率很低之后，会将数据页做合并。合并的过程，可以认为是分裂过程的逆过程。</p>
<p>基于业务字段做主键，往往不能保证插入的有序性，更容易造成页分裂，基于自增ID做主键，每插入一条记录都是追加操作，一般不会触发叶子结点分裂。由于每个非主键索引叶子结点都是主键的值，如果用整型做主键，只需要4个字节，如果是长整型，则是8个字节。</p>
<p><strong>显然，主键长度越小，普通索引的叶子节点就越小，普通索引占用的空间也就越小。</strong></p>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-7">
                                        <div class="post-content" data-content-type="full">
                                            <p><strong>索引的出现其实就是为了提高数据查询的效率，就像书的目录一样。</strong></p>
<h2 id="索引常见模型">索引常见模型</h2>
<h3 id="哈希表">哈希表</h3>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607160718.png" alt=""></p>
<p>哈希表是一种以键值对存储的数据结构，只要输入key，就可以根据key找到对应的vaule。不可避免的是会存在hash冲突，处理这种情况方法是拉出一个链表。（类比Java中HashMap结构）。</p>
<p>优点：</p>
<ul>
<li>查找速度快，新增速度也快。</li>
</ul>
<p>缺点：</p>
<ul>
<li>因为不是有序的，如果需要范围查询，速度是很慢的。</li>
</ul>
<p>哈希表这种结构适用于只有等值查询的场景，比如 Memcached 及其他一些 NoSQL 引擎。</p>
<h3 id="有序数组">有序数组</h3>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607160727.png" alt=""></p>
<p>有序数组查询时，可以使用二分法进行搜索，时间复杂度是O(log(N))，并且有序数据还支持范围查询。但是需要插入的时候，就需要进行数据挪动（因为要保证顺序），成本是非常高的。</p>
<p>因此，<strong>有序数组索引只适用于静态存储引擎</strong>。</p>
<h3 id="搜索树">搜索树</h3>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607160741.png" alt=""></p>
<p>二叉树的特点是：每个节点的左儿子小于父节点，父节点又小于右儿子。这样如果你要查 ID_card_n2 的话，按照图中的搜索顺序就是按照 UserA -&gt; UserC -&gt; UserF -&gt; User2 这个路径得到。这个时间复杂度是 O(log(N))。</p>
<p>当然为了维持 O(log(N)) 的查询复杂度，你就需要保持这棵树是平衡二叉树。为了做这个保证，更新的时间复杂度也是 O(log(N))。</p>
<p>二叉树的主要缺点是：当数据量很大的时候，树高会非常高，假如树高为20。一次查询可能需要访问 20 个数据块。在机械硬盘时代，从磁盘随机读一个数据块需要 10 ms 左右的寻址时间。也就是说，对于一个 100 万行的表，如果使用二叉树来存储，单独访问一个行可能需要 20 个 10 ms 的时间，这个查询可真够慢的。</p>
<h2 id="InnoDB-的索引模型">InnoDB 的索引模型</h2>
<p>在InnoDB中，表都是根据主键顺序以索引的形式存放的，这种存储方式的表称为索引组织表。<strong>InnoDB使用的是B+树索引模型</strong>，所以数据都是存储在B+树中的。</p>
<p><strong>每一个索引在InnoDB中对应一颗B+树。</strong></p>
<p><img src="http://qiniu.deveye.cn/blog/img/20220607162535.png" alt=""></p>
<p>从上图来看，索引类型分为：主键索引和非主键索引。</p>
<p><strong>主键索引在InnoDB中也成为聚簇索引（clustered index），非主键索引在InnoDB中成为二级索引（secondary index）。</strong></p>
<h3 id="基于主键索引和非主键索引搜索的区别：">基于主键索引和非主键索引搜索的区别：</h3>
<ul>
<li>
<p>基于主键索引查询只需要搜索对应的这颗B+树。</p>
</li>
<li>
<p>基于非主键索引首先先查到对应值的ID（假设ID为主键），再到ID索引树中搜索一次，这个过程称为回表。</p>
</li>
</ul>
<h2 id="索引的维护">索引的维护</h2>
<h3 id="页分裂">页分裂</h3>
<p>B+ 树为了维护索引的有序性，在插入新值的时候需要做必要的维护，如果插入的数据需要在页的中间，那么就需要进行数据的挪动，空出位置，如果插入的页刚好满了，就会触发<strong>页分裂</strong>，页分裂除了会影响性能，而且会使整体空间利用率降低50%（因为之前一个页，分裂成了两个）。</p>
<p>当然有分裂就有合并。当相邻两个页由于删除了数据，利用率很低之后，会将数据页做合并。合并的过程，可以认为是分裂过程的逆过程。</p>
<p>基于业务字段做主键，往往不能保证插入的有序性，更容易造成页分裂，基于自增ID做主键，每插入一条记录都是追加操作，一般不会触发叶子结点分裂。由于每个非主键索引叶子结点都是主键的值，如果用整型做主键，只需要4个字节，如果是长整型，则是8个字节。</p>
<p><strong>显然，主键长度越小，普通索引的叶子节点就越小，普通索引占用的空间也就越小。</strong></p>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2022-06-07T08:04:14.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2022-06-07
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                MySQL实战45讲
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="7" id="btn-7">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2022/06/07/%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%A0%E6%94%B9%E4%BA%86%E6%88%91%E8%BF%98%E7%9C%8B%E4%B8%8D%E8%A7%81/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                事务隔离：为什么你改了我还看不见？
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-8">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <p><strong>ACID (Atomicity、Consistency、Isolation、Durability)即原子性、一致性、隔离性、持久性。</strong></p>
<p>当数据库上有多个事务同时执行的时候，就可能会出现脏读（dirty read）、不可重复读（nonrepeatable read）、幻读（phantom read）的问题。</p>
<h3 id="隔离级别">隔离级别</h3>
<p>SQL标准的隔离级别包括：读未提交（read uncommitted）、读提交（read committed）、可重复度（repeatable read）和串行化（serializable）。</p>
<ul>
<li>
<p>读未提交：一个事务还没有提交时，它做的变更就能被别的事务看到。</p>
</li>
<li>
<p>读提交：一个事务提交之后，它做的变更才会被其他事务看到。</p>
</li>
<li>
<p>可重复读：一个事务执行过程中看到的数据，总是跟这个事务启动的时候看到的数据一致。当然在可重复读的隔离级别下，未提交的变更对其他事务也是不可见的。</p>
</li>
<li>
<p>串行化：对同一条记录“写”会加“写锁”，“读”会加“读锁”。当出现读写冲突的时候，后访问的事务必须等待前一个事务执行完成，才能继续执行。</p>
</li>
</ul>
<h3 id="事务隔离的实现">事务隔离的实现</h3>
<p><strong>数据库隔离的实现上会创建一个视图，访问的时候以视图的逻辑结果为准。</strong></p>
<p><strong>“可重复读”<strong>隔离级别下，这个视图是在</strong>事务启动时创建的</strong>，整个事务存在期间都会用这个视图。</p>
<p><strong>“读提交”<strong>隔离级别下，这个视图是在每个SQL语句</strong>开始执行的时候创建的</strong>。</p>
<p>**“读未提交”**隔离级别下直接返回记录上的最新值，<strong>没有视图的概念</strong>。</p>
<p><strong>“串行化”<strong>的隔离级别下直接使用</strong>加锁的方式避免并行访问</strong>。</p>
<p>在 MySQL 中，实际上每条记录在更新的时候都会同时记录一条回滚操作。记录上的最新值，通过回滚操作，都可以得到前一个状态的值。</p>
<p>假设一个值从 1 被按顺序改成了 2、3、4，在回滚日志里面就会有类似下面的记录。<br>
<img src="http://qiniu.deveye.cn/blog/img/20220607152436.png" alt=""></p>
<p>当前值是 4，但是在查询这条记录的时候，不同时刻启动的事务会有不同的 read-view。如图中看到的，在视图 A、B、C 里面，这一个记录的值分别是 1、2、4，同一条记录在系统中可以存在多个版本，就是数据库的多版本并发控制（MVCC）。对于 read-view A，要得到 1，就必须将当前值依次执行图中所有的回滚操作得到。</p>
<p>同时你会发现，即使现在有另外一个事务正在将 4 改成 5，这个事务跟 read-view A、B、C 对应的事务是不会冲突的。</p>
<p><strong>回滚日志系统会判断，当系统中没有比这个回滚日志更早的read-view的时候，日志会被删除。</strong></p>
<h3 id="建议不要使用长事务">建议不要使用长事务</h3>
<p>长事务意味着系统里面会存在很老的事务视图，由于这些事务随时可能访问数据库里面的任何数据，所以这个事务提交之前，数据库里面它可能用到的回滚记录都必须保留，这就会导致大量占用存储空间。</p>
<p>长事务还会占用锁资源，也可能拖垮整个库。</p>
<p>通过以下语句可以查询持续时间超过60s的事务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))&gt;60</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="事务的启动方式">事务的启动方式</h3>
<ol>
<li>
<p>显式启动，<code>begin或start transaction</code>。配套的提交语句是<code>commit</code>，回滚语句是<code>commit</code>。</p>
</li>
<li>
<p><code>set autocommit=0</code>，这个命令会将这个线程自动提交关闭。意味着如果你只执行select语句，这个事务就启动了，而且不会自动提交。这个事务持续存在直到你主动执行commit或rollback语句，或者断开连接。</p>
</li>
</ol>
<p><strong>建议使用<code>set autocommit=1</code>，通过显式语句的方式启动事务。</strong></p>
<p>在 autocommit 为 1 的情况下，用 begin 显式启动的事务，如果执行 commit 则提交事务。如果执行 commit work and chain，则是提交事务并自动启动下一个事务，这样也省去了再次执行 begin 语句的开销。同时带来的好处是从程序开发的角度明确地知道每个语句是否处于事务中。</p>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-8">
                                        <div class="post-content" data-content-type="full">
                                            <p><strong>ACID (Atomicity、Consistency、Isolation、Durability)即原子性、一致性、隔离性、持久性。</strong></p>
<p>当数据库上有多个事务同时执行的时候，就可能会出现脏读（dirty read）、不可重复读（nonrepeatable read）、幻读（phantom read）的问题。</p>
<h3 id="隔离级别">隔离级别</h3>
<p>SQL标准的隔离级别包括：读未提交（read uncommitted）、读提交（read committed）、可重复度（repeatable read）和串行化（serializable）。</p>
<ul>
<li>
<p>读未提交：一个事务还没有提交时，它做的变更就能被别的事务看到。</p>
</li>
<li>
<p>读提交：一个事务提交之后，它做的变更才会被其他事务看到。</p>
</li>
<li>
<p>可重复读：一个事务执行过程中看到的数据，总是跟这个事务启动的时候看到的数据一致。当然在可重复读的隔离级别下，未提交的变更对其他事务也是不可见的。</p>
</li>
<li>
<p>串行化：对同一条记录“写”会加“写锁”，“读”会加“读锁”。当出现读写冲突的时候，后访问的事务必须等待前一个事务执行完成，才能继续执行。</p>
</li>
</ul>
<h3 id="事务隔离的实现">事务隔离的实现</h3>
<p><strong>数据库隔离的实现上会创建一个视图，访问的时候以视图的逻辑结果为准。</strong></p>
<p><strong>“可重复读”<strong>隔离级别下，这个视图是在</strong>事务启动时创建的</strong>，整个事务存在期间都会用这个视图。</p>
<p><strong>“读提交”<strong>隔离级别下，这个视图是在每个SQL语句</strong>开始执行的时候创建的</strong>。</p>
<p>**“读未提交”**隔离级别下直接返回记录上的最新值，<strong>没有视图的概念</strong>。</p>
<p><strong>“串行化”<strong>的隔离级别下直接使用</strong>加锁的方式避免并行访问</strong>。</p>
<p>在 MySQL 中，实际上每条记录在更新的时候都会同时记录一条回滚操作。记录上的最新值，通过回滚操作，都可以得到前一个状态的值。</p>
<p>假设一个值从 1 被按顺序改成了 2、3、4，在回滚日志里面就会有类似下面的记录。<br>
<img src="http://qiniu.deveye.cn/blog/img/20220607152436.png" alt=""></p>
<p>当前值是 4，但是在查询这条记录的时候，不同时刻启动的事务会有不同的 read-view。如图中看到的，在视图 A、B、C 里面，这一个记录的值分别是 1、2、4，同一条记录在系统中可以存在多个版本，就是数据库的多版本并发控制（MVCC）。对于 read-view A，要得到 1，就必须将当前值依次执行图中所有的回滚操作得到。</p>
<p>同时你会发现，即使现在有另外一个事务正在将 4 改成 5，这个事务跟 read-view A、B、C 对应的事务是不会冲突的。</p>
<p><strong>回滚日志系统会判断，当系统中没有比这个回滚日志更早的read-view的时候，日志会被删除。</strong></p>
<h3 id="建议不要使用长事务">建议不要使用长事务</h3>
<p>长事务意味着系统里面会存在很老的事务视图，由于这些事务随时可能访问数据库里面的任何数据，所以这个事务提交之前，数据库里面它可能用到的回滚记录都必须保留，这就会导致大量占用存储空间。</p>
<p>长事务还会占用锁资源，也可能拖垮整个库。</p>
<p>通过以下语句可以查询持续时间超过60s的事务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))&gt;60</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="事务的启动方式">事务的启动方式</h3>
<ol>
<li>
<p>显式启动，<code>begin或start transaction</code>。配套的提交语句是<code>commit</code>，回滚语句是<code>commit</code>。</p>
</li>
<li>
<p><code>set autocommit=0</code>，这个命令会将这个线程自动提交关闭。意味着如果你只执行select语句，这个事务就启动了，而且不会自动提交。这个事务持续存在直到你主动执行commit或rollback语句，或者断开连接。</p>
</li>
</ol>
<p><strong>建议使用<code>set autocommit=1</code>，通过显式语句的方式启动事务。</strong></p>
<p>在 autocommit 为 1 的情况下，用 begin 显式启动的事务，如果执行 commit 则提交事务。如果执行 commit work and chain，则是提交事务并自动启动下一个事务，这样也省去了再次执行 begin 语句的开销。同时带来的好处是从程序开发的角度明确地知道每个语句是否处于事务中。</p>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2022-06-07T02:31:39.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2022-06-07
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                MySQL实战45讲
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="8" id="btn-8">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
            <article class="bg-white dark:bg-gray-800 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-700">
                <div class="flex flex-col">
                    <div class="flex-1">
                        <h3 class="text-xl font-semibold mb-3">
                            <a href="/2022/06/06/%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%E4%B9%8B%E4%B8%80%E6%9D%A1SQL%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84/" class="text-gray-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                日志系统：一条SQL更新语句是如何执行的?
                            </a>
                        </h3>
                        
                        
                        
                        
                            <div class="post-content-container mb-4">
                                <div class="post-content-preview text-gray-600 dark:text-gray-300 leading-relaxed" id="preview-9">
                                    <div class="post-content-preview-wrapper">
                                        <div class="post-content" data-content-type="preview">
                                            <h3 id="redo-log（重做日志）">redo log（重做日志）</h3>
<p>InnoDB 的 redo log 是固定大小的，比如可以配置为一组 4 个文件，每个文件的大小是 1GB，那么总共就可以记录 4GB 的操作。从头开始写，写到末尾就又回到开头循环写，如下面这个图所示。<br>
<img src="http://qiniu.deveye.cn/blog/img/20220606110553.png" alt=""></p>
<p>write pos 是当前记录的位置，一边写一边后移，写到第 3 号文件末尾后就回到 0 号文件开头。checkpoint 是当前要擦除的位置，也是往后推移并且循环的，擦除记录前要把记录更新到数据文件。</p>
<p>有了 redo log，InnoDB 就可以保证即使数据库发生异常重启，之前提交的记录都不会丢失，这个能力称为crash-safe。</p>
<h3 id="binlog（归档日志）">binlog（归档日志）</h3>
<p>binlog没有crash-safe能力，只能用于归档。</p>
<p>这两种日志的不同点：</p>
<ul>
<li>
<p>redo log是InnoDB引擎特有的，binlog是MySQL的server层实现的，所有引擎都可以使用。</p>
</li>
<li>
<p><strong>redo log是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑。</strong></p>
</li>
<li>
<p>redo log 是循环写的，空间固定会用完；binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。</p>
</li>
</ul>
<h3 id="两阶段提交">两阶段提交</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; update T set c=c+1 where ID=2;</span><br></pre></td></tr></table></figure>
<p>执行器和 InnoDB 引擎在执行这个简单的 update 语句时的内部流程:</p>
<ol>
<li>
<p>执行器先找引擎取 ID=2 这一行。ID 是主键，引擎直接用树搜索找到这一行。如果 ID=2 这一行所在的数据页本来就在内存中，就直接返回给执行器；否则，需要先从磁盘读入内存，然后再返回。</p>
</li>
<li>
<p>执行器拿到引擎给的行数据，把这个值加上 1，比如原来是 N，现在就是 N+1，得到新的一行数据，再调用引擎接口写入这行新数据。</p>
</li>
<li>
<p>引擎将这行新数据更新到内存中，同时将这个更新操作记录到 redo log 里面，此时 redo log 处于 prepare 状态。然后告知执行器执行完成了，随时可以提交事务。</p>
</li>
<li>
<p>执行器生成这个操作的 binlog，并把 binlog 写入磁盘。</p>
</li>
<li>
<p>执行器调用引擎的提交事务接口，引擎把刚刚写入的 redo log 改成提交（commit）状态，更新完成。</p>
</li>
</ol>
<p>流程图如下所示：<br>
<img src="http://qiniu.deveye.cn/blog/img/20220606112558.png" alt=""></p>
<h3 id="如何让数据库恢复到半个月任意一秒？">如何让数据库恢复到半个月任意一秒？</h3>
<ul>
<li>首先，找到最近的一次全量备份，如果你运气好，可能就是昨天晚上的一个备份，从这个备份恢复到临时库；</li>
<li>然后，从备份的时间点开始，将备份的 binlog 依次取出来，重放到中午误删表之前的那个时刻。</li>
</ul>
<h3 id="总结">总结</h3>
<p>建议<code>innodb_flush_log_at_trx_commit</code> 这个参数设置成 1 的时候，表示每次事务的 redo log 都直接持久化到磁盘，这样可以保证 MySQL 异常重启之后数据不丢失。</p>
<p>建议<code>sync_binlog </code>这个参数设置成 1 ，表示每次事务的 binlog 都持久化到磁盘，这样可以保证 MySQL 异常重启之后 binlog 不丢失。</p>
<iframe id="embed_dom" name="embed_dom" frameborder="0" style="display:block;width:715px; height:245px;" src="https://www.processon.com/embed/629f14fd07912907215003f8"></iframe>

                                        </div>
                                    </div>
                                    
                                        <div class="content-fade"></div>
                                    
                                </div>
                                
                                    <div class="post-content-full text-gray-600 dark:text-gray-300 leading-relaxed post-hidden" id="full-9">
                                        <div class="post-content" data-content-type="full">
                                            <h3 id="redo-log（重做日志）">redo log（重做日志）</h3>
<p>InnoDB 的 redo log 是固定大小的，比如可以配置为一组 4 个文件，每个文件的大小是 1GB，那么总共就可以记录 4GB 的操作。从头开始写，写到末尾就又回到开头循环写，如下面这个图所示。<br>
<img src="http://qiniu.deveye.cn/blog/img/20220606110553.png" alt=""></p>
<p>write pos 是当前记录的位置，一边写一边后移，写到第 3 号文件末尾后就回到 0 号文件开头。checkpoint 是当前要擦除的位置，也是往后推移并且循环的，擦除记录前要把记录更新到数据文件。</p>
<p>有了 redo log，InnoDB 就可以保证即使数据库发生异常重启，之前提交的记录都不会丢失，这个能力称为crash-safe。</p>
<h3 id="binlog（归档日志）">binlog（归档日志）</h3>
<p>binlog没有crash-safe能力，只能用于归档。</p>
<p>这两种日志的不同点：</p>
<ul>
<li>
<p>redo log是InnoDB引擎特有的，binlog是MySQL的server层实现的，所有引擎都可以使用。</p>
</li>
<li>
<p><strong>redo log是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑。</strong></p>
</li>
<li>
<p>redo log 是循环写的，空间固定会用完；binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。</p>
</li>
</ul>
<h3 id="两阶段提交">两阶段提交</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; update T set c=c+1 where ID=2;</span><br></pre></td></tr></table></figure>
<p>执行器和 InnoDB 引擎在执行这个简单的 update 语句时的内部流程:</p>
<ol>
<li>
<p>执行器先找引擎取 ID=2 这一行。ID 是主键，引擎直接用树搜索找到这一行。如果 ID=2 这一行所在的数据页本来就在内存中，就直接返回给执行器；否则，需要先从磁盘读入内存，然后再返回。</p>
</li>
<li>
<p>执行器拿到引擎给的行数据，把这个值加上 1，比如原来是 N，现在就是 N+1，得到新的一行数据，再调用引擎接口写入这行新数据。</p>
</li>
<li>
<p>引擎将这行新数据更新到内存中，同时将这个更新操作记录到 redo log 里面，此时 redo log 处于 prepare 状态。然后告知执行器执行完成了，随时可以提交事务。</p>
</li>
<li>
<p>执行器生成这个操作的 binlog，并把 binlog 写入磁盘。</p>
</li>
<li>
<p>执行器调用引擎的提交事务接口，引擎把刚刚写入的 redo log 改成提交（commit）状态，更新完成。</p>
</li>
</ol>
<p>流程图如下所示：<br>
<img src="http://qiniu.deveye.cn/blog/img/20220606112558.png" alt=""></p>
<h3 id="如何让数据库恢复到半个月任意一秒？">如何让数据库恢复到半个月任意一秒？</h3>
<ul>
<li>首先，找到最近的一次全量备份，如果你运气好，可能就是昨天晚上的一个备份，从这个备份恢复到临时库；</li>
<li>然后，从备份的时间点开始，将备份的 binlog 依次取出来，重放到中午误删表之前的那个时刻。</li>
</ul>
<h3 id="总结">总结</h3>
<p>建议<code>innodb_flush_log_at_trx_commit</code> 这个参数设置成 1 的时候，表示每次事务的 redo log 都直接持久化到磁盘，这样可以保证 MySQL 异常重启之后数据不丢失。</p>
<p>建议<code>sync_binlog </code>这个参数设置成 1 ，表示每次事务的 binlog 都持久化到磁盘，这样可以保证 MySQL 异常重启之后 binlog 不丢失。</p>
<iframe id="embed_dom" name="embed_dom" frameborder="0" style="display:block;width:715px; height:245px;" src="https://www.processon.com/embed/629f14fd07912907215003f8"></iframe>

                                        </div>
                                    </div>
                                
                            </div>
                        
                        
                        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                            <div class="flex items-center space-x-4">
                                <time datetime="2022-06-06T01:41:17.000Z" class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>
                                    2022-06-06
                                </time>
                                
                                
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
                                        
                                            <a href="/categories/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2/" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                                MySQL实战45讲
                                            </a>
                                        
                                    </div>
                                
                            </div>
                            
                            
                                <button class="expand-btn flex text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium items-center transition-colors text-sm" data-index="9" id="btn-9">
                                    <span class="expand-text">显示更多</span>
                                    <svg class="w-4 h-4 ml-1 expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                                </button>
                            
                        </div>
                    </div>
                </div>
            </article>
        
    </div>
    
    <!-- 分页 -->
    
        <nav class="flex justify-center mt-12">
            <div class="flex items-center space-x-2">
                
                
                <span class="px-4 py-2 bg-primary-600 text-white rounded-lg font-medium">
                    1 / 6
                </span>
                
                
                    <a href="/page/2/" class="px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center">
                        下一页
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg>
                    </a>
                
            </div>
        </nav>
    
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 绑定"显示更多"按钮事件
    document.querySelectorAll('.expand-btn').forEach(button => {
        button.addEventListener('click', function() {
            const index = this.getAttribute('data-index');
            toggleContent(index);
        });
    });
});

function toggleContent(index) {
    const preview = document.getElementById('preview-' + index);
    const full = document.getElementById('full-' + index);
    const btn = document.getElementById('btn-' + index);
    const expandText = btn.querySelector('.expand-text');
    const expandIcon = btn.querySelector('.expand-icon');

    if (full.classList.contains('post-hidden')) {
        // 展开内容
        preview.classList.add('post-hidden');
        full.classList.remove('post-hidden');
        full.classList.add('post-visible');
        expandText.textContent = '收起';
        expandIcon.style.transform = 'rotate(180deg)';
    } else {
        // 折叠内容
        preview.classList.remove('post-hidden');
        full.classList.add('post-hidden');
        full.classList.remove('post-visible');
        expandText.textContent = '显示更多';
        expandIcon.style.transform = 'rotate(0deg)';
    }
}
</script>

<style>
.expand-icon {
    transition: transform 0.3s ease;
}
.post-content-preview {
    position: relative;
}
.post-content-preview-wrapper {
    max-height: 300px;
    overflow: hidden;
    position: relative;
}
.content-fade {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100px;
    background: linear-gradient(to bottom, transparent, rgb(255 255 255 / 100%));
    pointer-events: none;
}
.dark .content-fade {
    background: linear-gradient(to bottom, transparent, rgb(31 41 55 / 100%));
}
.post-hidden {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transition: all 0.3s ease;
}

.post-visible {
    max-height: none;
    opacity: 1;
}
</style>

                                    </div>
                                </div>

                                
                                    <!-- 侧边栏 - 仅在非文章页显示 -->
                                    <aside class="main-sidebar hidden lg:block lg:w-72 xl:w-80 flex-shrink-0">
                                        <div class="space-y-6">
	<!-- 个人信息卡片 -->
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 text-center border border-gray-200 dark:border-gray-700">
		<div class="mb-4">
			
			<div class="relative inline-block">
				<img class="w-20 h-20 rounded-full mx-auto object-cover border-4 border-primary-100 dark:border-primary-800" 
					 src="/img/avatar.jpg" 
					 alt="KIM">
			</div>
			
		</div>
		
		<h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
			KIM
		</h3>
		
		
		<p class="text-gray-600 dark:text-gray-300 text-sm mb-4">
			stay hungry , stay foolish 
		</p>
		
		
		<!-- 社交链接 -->
		
	</div>

	<!-- 搜索框 -->
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
		<h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
			<svg class="w-4 h-4 mr-2 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg>
			搜索
		</h4>
		<div class="relative">
			<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
				<svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg>
			</div>
			<input type="text" 
				   placeholder="请输入关键词搜索..." 
				   class="w-full pl-8 pr-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
				   onclick="window.location.href='/search/'">
		</div>
	</div>

	<!-- 最近文章 -->
	
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
		<h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
			<svg class="w-4 h-4 mr-2 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg>
			最近文章
		</h4>
		<ul class="space-y-2">
			
			<li>
				<a href="/2025/06/15/%E5%B8%B8%E7%94%A8%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC/" 
				   class="block text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors line-clamp-2">
					常用构建脚本
				</a>
				<time class="text-xs text-gray-400 dark:text-gray-500">
					06-15
				</time>
			</li>
			
			<li>
				<a href="/2025/06/11/mermaid/" 
				   class="block text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors line-clamp-2">
					mermaid
				</a>
				<time class="text-xs text-gray-400 dark:text-gray-500">
					06-11
				</time>
			</li>
			
			<li>
				<a href="/2025/01/01/2025%E6%91%98%E6%8A%84/" 
				   class="block text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors line-clamp-2">
					2025摘抄
				</a>
				<time class="text-xs text-gray-400 dark:text-gray-500">
					01-01
				</time>
			</li>
			
			<li>
				<a href="/2024/12/31/2024%E6%91%98%E6%8A%84/" 
				   class="block text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors line-clamp-2">
					2024摘抄
				</a>
				<time class="text-xs text-gray-400 dark:text-gray-500">
					12-31
				</time>
			</li>
			
			<li>
				<a href="/2022/06/12/%E4%BA%8B%E5%8A%A1%E5%88%B0%E5%BA%95%E6%98%AF%E9%9A%94%E7%A6%BB%E7%9A%84%E8%BF%98%E6%98%AF%E4%B8%8D%E9%9A%94%E7%A6%BB%E7%9A%84%EF%BC%9F/" 
				   class="block text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors line-clamp-2">
					事务到底是隔离的还是不隔离的？
				</a>
				<time class="text-xs text-gray-400 dark:text-gray-500">
					06-12
				</time>
			</li>
			
		</ul>
	</div>
	

	<!-- 分类 -->
	
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
		<h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
			<svg class="w-4 h-4 mr-2 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
			分类
		</h4>
		<div class="space-y-1">
			
			<a href="/categories/Git/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>Git</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					6
				</span>
			</a>
			
			<a href="/categories/Java/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>Java</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					3
				</span>
			</a>
			
			<a href="/categories/Linux/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>Linux</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/MySQL/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>MySQL</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/categories/MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>MySQL实战45讲</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					7
				</span>
			</a>
			
			<a href="/categories/Netty/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>Netty</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/Nginx/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>Nginx</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/Redis/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>Redis</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					5
				</span>
			</a>
			
			<a href="/categories/RocketMQ/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>RocketMQ</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/categories/Tomcat/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>Tomcat</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/ddia/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>ddia</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/docker/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>docker</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/go/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>go</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/golang/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>golang</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/mermiad/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>mermiad</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/nginx/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>nginx</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/prometheus/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>prometheus</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E4%BA%BA%E7%94%9F/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>人生</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E5%85%B6%E4%BB%96/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>其他</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>多线程</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E5%AD%A6%E4%B9%A0/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>学习</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E5%B7%A5%E4%BD%9C/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>工作</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E6%91%98%E6%8A%84/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>摘抄</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/categories/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E6%B5%8B%E8%AF%95%E8%AF%BE/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>程序员的测试课</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E7%AE%97%E6%B3%95/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>算法</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					3
				</span>
			</a>
			
			<a href="/categories/%E8%84%9A%E6%9C%AC/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>脚本</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/categories/%E8%AF%BB%E4%B9%A6/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>读书</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					3
				</span>
			</a>
			
			<a href="/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>随手记</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
		</div>
	</div>
	

	<!-- 标签云 -->
	
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
		<h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
			<svg class="w-4 h-4 mr-2 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h.008v.008H6V6Z"></path></svg>
			标签
		</h4>
		<div class="flex flex-wrap gap-2">
			
			<a href="/tags/Git/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				Git
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					6
				</span>
			</a>
			
			<a href="/tags/Java/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				Java
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					4
				</span>
			</a>
			
			<a href="/tags/Linux/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				Linux
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/MySQL/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				MySQL
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					9
				</span>
			</a>
			
			<a href="/tags/Netty/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				Netty
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/Nginx/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				Nginx
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/Redis/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				Redis
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					6
				</span>
			</a>
			
			<a href="/tags/RocketMQ/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				RocketMQ
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					2
				</span>
			</a>
			
			<a href="/tags/String/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				String
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/Tomcat/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				Tomcat
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/docker/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				docker
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/go/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				go
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/golang/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				golang
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/hexo/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				hexo
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/juc/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				juc
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/mermaid/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				mermaid
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/nginx/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				nginx
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/prometheus/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				prometheus
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/shell/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				shell
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E4%BA%BA%E7%94%9F/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				人生
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E5%85%B6%E4%BB%96/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				其他
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				分布式
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				分布式锁
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				多线程
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E5%AD%A6%E4%B9%A0/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				学习
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E6%91%98%E6%8A%84/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				摘抄
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					2
				</span>
			</a>
			
			<a href="/tags/%E6%B5%8B%E8%AF%95/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				测试
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E7%AE%97%E6%B3%95/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				算法
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					3
				</span>
			</a>
			
			<a href="/tags/%E7%BF%BB%E8%AF%91/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				翻译
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E8%AF%BB%E4%B9%A6/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				读书
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					2
				</span>
			</a>
			
			<a href="/tags/%E8%BD%AC%E8%BD%BD/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				转载
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					2
				</span>
			</a>
			
			<a href="/tags/%E8%BF%90%E7%BB%B4/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				运维
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
			<a href="/tags/%E9%9A%8F%E6%89%8B%E8%AE%B0/" 
			   class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors">
				随手记
				<span class="ml-1 text-primary-600 dark:text-primary-300">
					1
				</span>
			</a>
			
		</div>
	</div>
	

	<!-- 归档 -->
	<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700">
		<h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
			<svg class="w-4 h-4 mr-2 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"></path></svg>
			归档
		</h4>
		<div class="space-y-1">
			
			<a href="/archives/2025/06/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2025年06月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/archives/2025/01/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2025年01月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2024/12/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2024年12月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2022/06/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2022年06月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					7
				</span>
			</a>
			
			<a href="/archives/2022/05/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2022年05月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/archives/2022/04/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2022年04月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					3
				</span>
			</a>
			
			<a href="/archives/2022/02/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2022年02月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/archives/2021/09/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2021年09月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2021/04/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2021年04月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					4
				</span>
			</a>
			
			<a href="/archives/2021/03/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2021年03月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					8
				</span>
			</a>
			
			<a href="/archives/2021/01/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2021年01月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2020/10/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2020年10月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/archives/2020/09/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2020年09月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2020/08/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2020年08月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					3
				</span>
			</a>
			
			<a href="/archives/2020/07/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2020年07月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/archives/2020/05/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2020年05月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					2
				</span>
			</a>
			
			<a href="/archives/2019/09/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2019年09月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					3
				</span>
			</a>
			
			<a href="/archives/2019/08/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2019年08月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2019/02/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2019年02月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2019/01/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2019年01月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
			<a href="/archives/2018/07/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2018年07月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					3
				</span>
			</a>
			
			<a href="/archives/2018/06/" 
			   class="flex items-center justify-between text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors py-1">
				<span>2018年06月</span>
				<span class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">
					1
				</span>
			</a>
			
		</div>
	</div>
</div>
                                    </aside>
                                    
                            </div>
                        </div>
                    </main>

                    <!-- 页脚 -->
                    <footer class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-12">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="text-center">
            <p class="text-gray-600 dark:text-gray-400 mb-2">
                无常是常 @ All Rights Reserved 2025
            </p>
            
                <p class="text-gray-500 dark:text-gray-500 text-sm"><a href="https://beian.miit.gov.cn" target="_blank">陕ICP备16008414号-1</a></p>
                
        </div>
    </div>
</footer>

<!-- 回到顶部按钮 -->
<button id="back-to-top"
    class="fixed bottom-8 right-8 bg-primary-600 hover:bg-primary-700 text-white p-3 rounded-full shadow-lg transition-all duration-300 opacity-0 invisible z-50">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"></path></svg>
</button>
            </div>
        </body>
        <!-- JavaScript -->
        <script src="/js/plugins.js" defer></script>
        <!-- Mermaid 支持 -->
        
            <script src="/js/mermaid.min.js"></script>
            <script defer>
                window.addEventListener('load', function () {
                    // 初始化 Mermaid 并让其自动渲染
                    mermaid.initialize({
                        theme: 'default',
                        startOnLoad: true, // 启用自动渲染
                        securityLevel: 'loose',

                        // 为各个图表类型配置自适应宽度
                        flowchart: {
                            htmlLabels: 'true',
                            curve: 'linear',
                            useMaxWidth: true
                        },
                        sequence: {
                            diagramMarginX: '50',
                            diagramMarginY: '10',
                            actorMargin: '50',
                            width: '150',
                            height: '65',
                            boxMargin: '10',
                            boxTextMargin: '5',
                            noteMargin: '10',
                            messageMargin: '35',
                            mirrorActors: 'true',
                            bottomMarginAdj: '1',
                            useMaxWidth: true
                        },
                        class: {
                            useMaxWidth: true
                        },
                        state: {
                            useMaxWidth: true
                        },
                        gantt: {
                            useMaxWidth: true
                        },
                        journey: {
                            useMaxWidth: true
                        }
                    });
                });
            </script>

            <!-- Mermaid 样式 -->
            <style>
                .mermaid {
                    text-align: center;
                    margin: 1.5em 0;
                    padding: 1rem;
                    background: #f8f9fa;
                    border-radius: 0.5rem;
                    border: 1px solid #e9ecef;
                    overflow-x: auto;
                    overflow-y: visible;
                    max-width: 100%;
                    box-sizing: border-box;
                }

                .mermaid-rendered {
                    background: transparent;
                    border: none;
                    padding: 0;
                }

                .mermaid-error {
                    color: #dc3545;
                    background-color: #f8d7da;
                    border: 1px solid #f5c6cb;
                    border-radius: 0.375rem;
                    padding: 0.75rem;
                    margin: 1rem 0;
                    font-family: monospace;
                    text-align: left;
                }

                /* 深色模式下的 Mermaid 样式 */
                .dark .mermaid {
                    background: #374151;
                    border-color: #4b5563;
                }

                .dark .mermaid-error {
                    color: #f8d7da;
                    background-color: #2d1b1e;
                    border-color: #842029;
                }

                /* 确保 Mermaid 图表在深색模式下可见 */
                .dark .mermaid svg {
                    background-color: transparent;
                }

                /* Mermaid 图表样式优化 */
                .mermaid svg {
                    max-width: 100%;
                    height: auto;
                    display: block;
                    margin: 0 auto;
                    /* 保持原始比例，但不超过容器 */
                    width: auto;
                }

                /* Mermaid 图表容器已在上面定义，这里添加额外的响应式处理 */

                /* 针对大型图表的滚动条样式 */
                .mermaid::-webkit-scrollbar {
                    height: 8px;
                }

                .mermaid::-webkit-scrollbar-track {
                    background: #f1f1f1;
                    border-radius: 4px;
                }

                .mermaid::-webkit-scrollbar-thumb {
                    background: #c1c1c1;
                    border-radius: 4px;
                }

                .mermaid::-webkit-scrollbar-thumb:hover {
                    background: #a8a8a8;
                }

                /* 深色模式下的滚动条 */
                .dark .mermaid::-webkit-scrollbar-track {
                    background: #4b5563;
                }

                .dark .mermaid::-webkit-scrollbar-thumb {
                    background: #6b7280;
                }

                .dark .mermaid::-webkit-scrollbar-thumb:hover {
                    background: #9ca3af;
                }
            </style>
            

</html>