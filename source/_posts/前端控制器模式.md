---
title: 前端控制器模式
date: 2018-12-11 14:35:56
tags: desgin-patterns
categories: java
---

**前端控制器(front controller)主要提供一种可以集中式管理请求的控制器，一个前端控制器可以接受所有的客户请求，将每个请求递交给相应的请求句柄，并适当地响应用户。**    

![](/img/front-controller.png)

- 定义一个视图接口和显示的方法

```
/**
 *
 * Views are the representations rendered for the user.
 *
 */
public interface View {

  void display();
}
```
- `CatapultView` 和  `ArcherView` 类实现视图接口，输出对应的内容

```
/**
 *
 * View for catapults.
 *
 */
public class CatapultView implements View {

  private static final Logger LOGGER = LoggerFactory.getLogger(CatapultView.class);

  @Override
  public void display() {
    LOGGER.info("Displaying catapults");
  }
}
```

```
/**
 *
 * View for archers.
 *
 */
public class ArcherView implements View {

  private static final Logger LOGGER = LoggerFactory.getLogger(ArcherView.class);

  @Override
  public void display() {
    LOGGER.info("Displaying archers");
  }
}
```

- 定义一个`Command`接口和声明了一个`process()`方法用于处理发送的请求

```
/**
 *
 * Commands are the intermediary between requests and views.
 *
 */
public interface Command {

  void process();
}
```

- `ArcherCommand` 和 `CatapultCommand` 继承`Command` 接口处理对应的请求内容

```
/**
 *
 * Command for catapults.
 *
 */
public class CatapultCommand implements Command {

  @Override
  public void process() {
    new CatapultView().display();
  }
}

```

```
/**
 *
 * Command for archers.
 *
 */
public class ArcherCommand implements Command {

  @Override
  public void process() {
    new ArcherView().display();
  }
}

```

- `FrontController` 类接受所有请求并分发给对应的处理类

```
/**
 *
 * FrontController is the handler class that takes in all the requests and renders the correct
 * response.
 *
 */
public class FrontController {

  public void handleRequest(String request) {
    Command command = getCommand(request);
    command.process();
  }

  private Command getCommand(String request) {
    Class<?> commandClass = getCommandClass(request);
    try {
      return (Command) commandClass.newInstance();
    } catch (Exception e) {
      throw new ApplicationException(e);
    }
  }

  private static Class<?> getCommandClass(String request) {
    Class<?> result;
    try {
      result = Class.forName("com.iluwatar.front.controller." + request + "Command");
    } catch (ClassNotFoundException e) {
      result = UnknownCommand.class;
    }
    return result;
  }
}
```

- 测试方法

```
public class App {

  /**
   * Program entry point
   *
   * @param args
   *          command line args
   */
  public static void main(String[] args) {
    FrontController controller = new FrontController();
    controller.handleRequest("Archer");
    controller.handleRequest("Catapult");
    controller.handleRequest("foobar");
  }
}
//返回结果为
14:33:11.401 [main] INFO com.iluwatar.front.controller.ArcherView - Displaying archers
14:33:11.404 [main] INFO com.iluwatar.front.controller.CatapultView - Displaying catapults
14:33:11.404 [main] ERROR com.iluwatar.front.controller.ErrorView - Error 500
```

> 参考地址:https://github.com/iluwatar/java-design-patterns/tree/master/front-controller
